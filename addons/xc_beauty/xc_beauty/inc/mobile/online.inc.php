<?php
 goto chJqq; c7cjj: $token = $config["\143\x6f\x6e\164\145\x6e\164"]["\x74\x6f\153\145\x6e"]; goto dbTRn; CZfbd: $uniacid = $_W["\165\x6e\151\141\143\x69\x64"]; goto BwNOS; BVdcO: class Online { public $token, $uniacid; public function __construct($token, $uniacid, $appid) { goto h9ATj; hF0wS: $this->uniacid = $uniacid; goto PHfK8; PHfK8: $this->appid = $appid; goto zeXKo; h9ATj: $this->token = $token; goto hF0wS; zeXKo: } public function check_server() { goto hIy7S; uWWoS: $this->responseMsg(); goto i13qz; aDo2l: $this->valid(); goto w33kv; i13qz: goto jO0Hk; goto iQQDW; w33kv: jO0Hk: goto lN0qB; iQQDW: Qkiyz: goto aDo2l; hIy7S: if (isset($_GET["\145\143\150\x6f\163\164\x72"])) { goto Qkiyz; } goto uWWoS; lN0qB: } public function valid() { goto th6i5; oQ5fC: rZTFW: goto Hibxd; px1_m: header("\143\x6f\156\164\x65\156\164\x2d\x74\171\x70\x65\72\164\x65\170\x74"); goto VztvD; JynWH: echo $echoStr . "\x2b\x2b\53" . $this->token; goto UQ38c; VztvD: echo $echoStr; goto Hk6Rq; dhCn4: if ($this->checkSignature()) { goto ufZNI; } goto JynWH; th6i5: $echoStr = $_GET["\145\x63\150\157\x73\x74\x72"]; goto dhCn4; XtDZa: ufZNI: goto px1_m; UQ38c: exit; goto FSRcS; Hk6Rq: exit; goto oQ5fC; FSRcS: goto rZTFW; goto XtDZa; Hibxd: } private function checkSignature() { goto VFH1D; veUBt: sort($tmpArr, SORT_STRING); goto hFfwi; p_4W0: pWrhY: goto C1yq0; Z63tO: DpiKr: goto sXeeY; gQ53i: $tmpArr = array($token, $timestamp, $nonce); goto veUBt; LetO3: $nonce = $_GET["\x6e\157\156\143\x65"]; goto vNUzt; zmQHd: return false; goto Sw55f; QzQKZ: $timestamp = $_GET["\x74\x69\x6d\x65\x73\164\x61\155\x70"]; goto LetO3; vNUzt: $token = $this->token; goto gQ53i; jYsW1: $tmpStr = sha1($tmpStr); goto tE_aH; hFfwi: $tmpStr = implode($tmpArr); goto jYsW1; C1yq0: return true; goto Z63tO; Sw55f: goto DpiKr; goto p_4W0; VFH1D: $signature = $_GET["\x73\151\x67\x6e\141\164\x75\x72\x65"]; goto QzQKZ; tE_aH: if ($tmpStr == $signature) { goto pWrhY; } goto zmQHd; sXeeY: } public function responseMsg() { goto bw9DC; KihPP: exit; goto DwLWW; TNWdl: echo "\x73\x75\143\x63\x65\163\x73"; goto KihPP; lWOVN: $data["\165\156\x69\x61\x63\x69\144"] = $this->uniacid; goto D804y; wH7Of: $postArr = json_decode($postStr, true); goto eb3g6; czd9k: goto HYVl7; goto ig7NF; rG7iw: if ($postArr["\x4d\x73\147\x54\x79\x70\145"] == "\x65\166\145\156\164" && $postArr["\x45\x76\145\156\164"] == "\165\x73\145\162\137\x65\156\164\145\162\137\x74\x65\x6d\160\163\145\x73\x73\x69\x6f\x6e") { goto e9P74; } goto czd9k; DwLWW: zCyeW: goto Dc1ey; bw9DC: $postStr = file_get_contents("\x70\x68\x70\72\x2f\x2f\x69\x6e\160\x75\164"); goto IrY8M; D804y: $data["\157\x70\145\x6e\151\x64"] = $postArr["\x46\162\x6f\x6d\x55\x73\x65\x72\x4e\141\155\x65"]; goto svgfe; eSyYq: $data["\x75\x6e\151\141\x63\151\144"] = $this->uniacid; goto F8vo2; OQ0ZB: goto zCyeW; goto Wv6Xo; Qj3AQ: $data["\164\x79\160\145"] = 2; goto MpZh2; wZr8c: exit; goto OQ0ZB; eb3g6: if (!empty($postArr["\x4d\163\x67\124\171\x70\x65"]) && $postArr["\115\x73\x67\124\x79\160\x65"] == "\164\145\x78\164") { goto A14OS; } goto NTjC0; svgfe: $data["\164\x79\x70\145"] = 1; goto uiDh5; UgMUS: e9P74: goto weZXq; weZXq: HYVl7: goto TNWdl; gLHZz: $this->checkOnline($data); goto JZlN2; Yb5hs: $this->checkOnline($data); goto KY9eH; uiDh5: $data["\143\x6f\156\x74\145\156\164"] = base64_encode($postArr["\103\157\x6e\x74\x65\156\164"]); goto gLHZz; KY9eH: goto HYVl7; goto UgMUS; JZlN2: goto HYVl7; goto n2BF0; F8vo2: $data["\x6f\x70\x65\156\151\x64"] = $postArr["\x46\x72\x6f\x6d\125\x73\145\162\x4e\x61\155\145"]; goto Qj3AQ; Wv6Xo: jlsZ8: goto wH7Of; n2BF0: Grqn3: goto eSyYq; ig7NF: A14OS: goto lWOVN; NTjC0: if (!empty($postArr["\115\163\147\x54\171\160\x65"]) && $postArr["\115\163\x67\124\x79\160\x65"] == "\151\x6d\x61\147\145") { goto Grqn3; } goto rG7iw; MpZh2: $data["\143\x6f\x6e\164\145\156\164"] = $postArr["\120\151\143\x55\162\154"]; goto Yb5hs; IrY8M: if (!empty($postStr) && is_string($postStr)) { goto jlsZ8; } goto ynBfs; ynBfs: echo ''; goto wZr8c; Dc1ey: } public function checkOnline($data) { goto f7Se6; gnrLQ: if (!$config) { goto XJ8Al; } goto Wlvkr; WCeMo: ALdz_: goto Qc6D0; oRQov: OWo_f: goto WCeMo; f7Se6: $online = pdo_get("\170\143\137\x62\145\x61\165\x74\x79\137\157\156\x6c\x69\156\x65\163", array("\x75\156\x69\x61\143\151\144" => $data["\x75\156\x69\x61\143\x69\x64"], "\157\160\145\156\x69\144" => $data["\157\x70\x65\x6e\x69\x64"])); goto AksyJ; Qc6D0: bXoS0: goto r97kP; LtsDg: XJ8Al: goto oRQov; grKAI: l4T9o: goto LtsDg; jQQnL: $config = pdo_get("\170\143\137\142\145\x61\x75\x74\x79\137\143\x6f\x6e\146\x69\147", array("\170\153\145\171" => "\x6f\x6e\x6c\x69\x6e\145", "\165\156\x69\141\x63\x69\x64" => $this->uniacid)); goto gnrLQ; vDFhU: if ($prev) { goto yLv0P; } goto riJQb; ymi4y: $request = pdo_insert("\x78\143\137\x62\x65\x61\x75\x74\171\x5f\x6f\x6e\x6c\x69\x6e\145\163", array("\x75\x6e\x69\x61\x63\x69\144" => $data["\165\156\x69\x61\143\x69\x64"], "\x6f\x70\145\x6e\151\x64" => $data["\157\160\145\156\151\x64"], "\x6d\145\155\142\x65\162" => 1, "\165\x70\144\141\x74\145\x74\x69\155\145" => date("\x59\55\x6d\x2d\x64\x20\110\72\151\72\x73"), "\164\x79\160\x65" => $data["\x74\171\160\145"], "\x63\157\x6e\x74\145\156\164" => $data["\143\157\156\x74\x65\x6e\x74"], "\143\x72\145\141\x74\145\x74\x69\x6d\145" => date("\131\x2d\x6d\55\x64\x20\110\x3a\x69\72\163"))); goto fFHqD; hxjOi: $this->sendMon($data); goto F5iZz; riJQb: $this->sendMon($data); goto dXGna; Or0gJ: pdo_query($sql, array("\72\164\151\x6d\145\x73" => date("\x59\55\x6d\55\x64\x20\x48\72\151\72\x73"), "\72\x69\x64" => $online["\x69\144"], "\x3a\165\156\x69\x61\143\x69\x64" => $data["\165\x6e\x69\141\x63\x69\144"], "\72\x74\x79\160\145" => $data["\x74\171\x70\145"], "\72\143\x6f\156\164\x65\x6e\164" => $data["\143\x6f\x6e\x74\x65\x6e\164"])); goto uWbZi; AzHtB: pdo_insert("\170\143\x5f\x62\x65\x61\x75\x74\x79\x5f\157\156\154\151\x6e\145\x5f\154\x6f\147", $data); goto ed8QU; dXGna: goto OWo_f; goto Tq2U1; AksyJ: if ($online) { goto a1QDs; } goto ymi4y; GSvmP: $data["\x63\162\x65\141\x74\x65\164\151\155\x65"] = date("\x59\55\x6d\x2d\144\40\110\72\x69\x3a\x73"); goto VtGXG; fFHqD: if (!$request) { goto CyKOc; } goto z5QEF; D3mk8: if (!(time() - strtotime($prev[0]["\x63\162\145\141\x74\145\x74\x69\155\145"]) >= intval($config["\x63\x6f\156\x74\x65\156\164"]["\x6a\151\x61\156\147\x65"]))) { goto Z3Dc5; } goto hxjOi; F5iZz: Z3Dc5: goto grKAI; XJqhc: if (empty($config["\143\x6f\156\164\145\x6e\x74"]["\x6a\151\x61\156\x67\x65"])) { goto l4T9o; } goto D3mk8; Wlvkr: $config["\143\x6f\156\164\x65\156\164"] = json_decode($config["\143\x6f\156\x74\145\x6e\164"], true); goto XJqhc; AUwD8: a1QDs: goto Fk7uQ; lwX_S: goto bXoS0; goto AUwD8; oQqhx: $data["\x63\162\x65\x61\164\145\x74\x69\155\145"] = date("\x59\x2d\x6d\55\144\x20\110\x3a\x69\x3a\163"); goto AzHtB; Tq2U1: yLv0P: goto jQQnL; f9G28: $sql = "\125\120\x44\x41\124\105\x20" . tablename("\170\143\137\142\x65\x61\165\x74\x79\137\x6f\x6e\x6c\151\156\145\163") . "\x20\123\105\x54\40\155\145\155\142\x65\162\75\x6d\x65\x6d\142\145\x72\53\x31\x2c\x75\160\x64\141\164\x65\164\151\x6d\x65\x3d\x3a\164\x69\x6d\145\x73\x2c\164\x79\160\145\x3d\72\x74\171\160\x65\x2c\143\x6f\156\x74\x65\x6e\x74\x3d\x3a\143\x6f\x6e\x74\x65\156\164\40\x57\110\105\x52\x45\x20\x69\144\x3d\72\x69\144\x20\x41\116\x44\40\165\x6e\x69\141\x63\151\144\75\72\x75\156\151\141\x63\x69\144"; goto Or0gJ; z5QEF: $data["\160\151\x64"] = pdo_insertid(); goto oQqhx; uWbZi: $prev = pdo_getall("\170\143\137\142\x65\x61\165\164\x79\137\157\156\154\x69\x6e\145\137\x6c\157\x67", array("\165\156\151\x61\143\151\144" => $data["\165\156\x69\x61\x63\151\x64"], "\x70\x69\x64" => $data["\160\x69\x64"], "\144\165\x74\171" => 2), array(), '', "\x63\x72\x65\141\164\145\164\151\x6d\x65\40\104\x45\123\103\54\x69\x64\x20\x44\x45\x53\103", array(1, 5)); goto vDFhU; UuSMt: if (!$request) { goto ALdz_; } goto f9G28; H1xC7: CyKOc: goto lwX_S; Fk7uQ: $data["\x70\x69\144"] = $online["\151\x64"]; goto GSvmP; VtGXG: $request = pdo_insert("\170\x63\137\x62\145\x61\x75\164\x79\137\157\x6e\154\151\156\x65\x5f\154\x6f\147", $data); goto UuSMt; ed8QU: $this->sendMon($data); goto H1xC7; r97kP: } public function sendMon($data) { goto B7Z_k; PbQlC: $openids = $config["\143\157\156\x74\x65\x6e\x74"]["\165\163\x65\162\154\x69\x73\x74"]; goto smRnP; LFaCG: YN4mV: goto MX9Sv; r_Fqd: momessv2($accessurl, $template, $sendopenid, $templateParam); goto T0YRR; U3gNI: yoE7d: goto EDRSV; A9LXF: if (!$web) { goto umHkT; } goto AxjNv; MEO7Z: if (!$web) { goto zRsXG; } goto EmS2w; Ygw9N: $token = $account_api->getAccessToken(); goto WYwOv; Dhj2c: $template = $config["\143\157\x6e\x74\x65\156\164"]["\x78\x63"]; goto q3HgQ; c6kTM: curl_setopt($ch, CURLOPT_HEADER, 0); goto cHmIr; IvSHn: zqAwf: goto r_Fqd; B7Z_k: $templateParam = array("\167\x65\142\156\x61\x6d\145\170" => "\xe6\x97\240", "\x6e\151\143\153" => "\346\227\xa0", "\143\x6f\156\x74\x65\156\x74" => "\xe6\x97\xa0", "\x61\160\x70\x69\x64" => $this->appid, "\160\x61\x67\145" => "\170\143\137\142\145\141\165\164\x79\57\x70\141\x67\x65\x73\x2f\142\x61\x73\145\57\142\x61\x73\145\77\x73\x68\141\x72\x65\75\57\x78\x63\137\x62\145\x61\165\164\171\x2f\165\151\x32\x2f\157\156\154\x69\156\145\57\x69\x6e\x64\x65\x78"); goto HiEh9; mpaNE: $accessurl = $web["\x63\x6f\156\x74\x65\156\164"]["\170\x63\x6d\145\163\163\x61\147\x65"] . "\46\157\x70\75\x73\145\156\x64\166\62"; goto Dhj2c; obQ7c: if (!($userinfo && !empty($userinfo["\x6e\151\x63\153"]))) { goto fqI0n; } goto XpPDF; OX1xV: if (empty($config["\x63\x6f\x6e\x74\145\x6e\x74"])) { goto Bw4L0; } goto v3nnE; yK18L: sIFEV: goto b3lvP; t9CVV: curl_setopt($ch, CURLOPT_URL, $url); goto c6kTM; EDRSV: $web = pdo_get("\x78\143\137\142\x65\141\x75\x74\x79\137\x63\157\x6e\146\151\147", array("\x78\x6b\145\171" => "\x77\145\x62", "\x75\x6e\x69\141\x63\x69\144" => $this->uniacid)); goto MEO7Z; MuL3t: if (!(!empty($web["\x63\x6f\x6e\x74\x65\156\x74"]) && !empty($web["\143\x6f\x6e\x74\x65\156\164"]["\164\x69\x74\x6c\x65"]))) { goto sIFEV; } goto gBR89; T0YRR: if (!($config["\143\157\x6e\x74\x65\x6e\x74"]["\x72\x65\x70\x6c\171\137\163\164\x61\x74\x75\163"] == 1 && !empty($config["\x63\157\156\164\x65\156\164"]["\162\x65\160\154\171\x5f\x63\x6f\x6e\164\145\156\164"]))) { goto m8srN; } goto nA0_k; Owgsr: m8srN: goto Ias0s; KN9jM: curl_close($ch); goto Owgsr; EmS2w: $web["\143\157\x6e\x74\x65\x6e\164"] = json_decode($web["\143\x6f\x6e\x74\145\156\x74"], true); goto MuL3t; rHyq7: umHkT: goto mpaNE; hy2l0: $userinfo = pdo_get("\x78\143\x5f\x62\145\x61\165\164\171\x5f\x75\163\x65\x72\x69\x6e\146\x6f", array("\165\x6e\x69\141\143\x69\x64" => $this->uniacid, "\x6f\x70\145\156\x69\144" => $data["\x6f\160\145\156\151\x64"])); goto obQ7c; trY1Z: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); goto HvTCk; WYwOv: $url = "\x68\x74\164\x70\x73\x3a\57\x2f\x61\x70\x69\56\x77\145\151\170\151\156\x2e\x71\161\56\x63\x6f\155\x2f\143\147\x69\x2d\142\151\x6e\57\155\145\x73\x73\x61\147\x65\x2f\143\x75\163\164\x6f\155\x2f\x73\x65\156\144\x3f\x61\143\143\145\x73\x73\x5f\x74\157\x6b\145\x6e\x3d" . $token; goto bsJWc; NhNLb: if (!($data["\x74\171\x70\x65"] == 2)) { goto Em3WG; } goto QuYkB; Ias0s: Bw4L0: goto Poctz; n7L2l: fqI0n: goto PVjTp; QKNBA: Em3WG: goto WbK1t; XpPDF: $templateParam["\x6e\151\x63\153"] = base64_decode($userinfo["\x6e\x69\x63\x6b"]); goto n7L2l; vX0L3: $postFields = json_encode($data, JSON_UNESCAPED_UNICODE); goto uOk0b; zz_8R: $config["\x63\x6f\156\x74\145\156\164"] = json_decode($config["\143\x6f\x6e\x74\x65\x6e\x74"], true); goto OX1xV; cHmIr: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto trY1Z; HvTCk: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE); goto UokVb; PVjTp: if ($data["\164\171\x70\x65"] == 1) { goto YN4mV; } goto NhNLb; uOk0b: $ch = curl_init(); goto t9CVV; smRnP: $sendopenid = array(); goto iWbwv; sLiHn: $pdata = curl_exec($ch); goto KN9jM; b3lvP: zRsXG: goto hy2l0; WbK1t: goto zqAwf; goto LFaCG; iWbwv: foreach ($openids as $itemopenis) { $sendopenid[] = $itemopenis["\157\160\145\156\x69\x64"]; Rocu6: } goto U3gNI; IrtQR: curl_setopt($ch, CURLOPT_POSTFIELDS, $postFields); goto sLiHn; QuYkB: $templateParam["\x63\157\x6e\164\x65\156\x74"] = "\xe5\x9b\xbe\347\211\x87"; goto QKNBA; gBR89: $templateParam["\x77\x65\x62\x6e\141\x6d\x65\170"] = $web["\143\x6f\156\164\x65\156\x74"]["\x74\x69\164\x6c\x65"]; goto yK18L; Poctz: v5ktE: goto oso0K; AxjNv: $web["\x63\157\156\x74\145\156\164"] = json_decode($web["\x63\157\156\164\x65\x6e\x74"], true); goto rHyq7; v3nnE: $web = pdo_get("\170\x63\x5f\142\145\141\165\x74\x79\137\x63\157\156\x66\x69\x67", array("\x78\153\x65\x79" => "\x77\145\142", "\165\156\151\x61\143\x69\144" => $data["\165\x6e\x69\x61\143\151\144"])); goto A9LXF; LGP6b: if (!$config) { goto v5ktE; } goto zz_8R; UokVb: curl_setopt($ch, CURLOPT_POST, true); goto IrtQR; nA0_k: $account_api = WeAccount::create(); goto Ygw9N; q3HgQ: $template["\x64\x61\164\141"] = $config["\143\x6f\x6e\x74\145\x6e\x74"]["\144\x61\x74\x61"]; goto PbQlC; MX9Sv: $templateParam["\143\x6f\156\164\145\156\x74"] = base64_decode($data["\143\157\156\x74\x65\x6e\x74"]); goto IvSHn; bsJWc: $data = array("\164\157\x75\x73\x65\x72" => $data["\157\160\145\156\151\144"], "\x6d\163\147\164\171\x70\x65" => "\164\145\170\164", "\164\145\170\x74" => array("\143\157\156\164\x65\156\164" => $config["\x63\157\x6e\x74\145\x6e\164"]["\162\145\x70\154\x79\137\143\157\156\164\145\x6e\164"])); goto vX0L3; HiEh9: $config = pdo_get("\170\143\x5f\142\145\x61\165\x74\x79\137\143\x6f\x6e\146\x69\x67", array("\x78\153\145\171" => "\x6f\x6e\x6c\151\156\x65", "\x75\x6e\x69\x61\143\x69\144" => $data["\165\156\x69\x61\143\151\x64"])); goto LGP6b; oso0K: } } goto ByTeN; upKGH: czlUL: goto Y28Dr; Y28Dr: $online = new Online($token, $uniacid, $_W["\x61\x63\143\x6f\165\x6e\x74"]["\153\x65\171"]); goto T_Jh8; dbTRn: bo7fk: goto upKGH; ByTeN: $token = ''; goto dNERk; fek1f: if (!(!empty($config["\143\x6f\x6e\164\x65\156\x74"]) && !empty($config["\143\157\156\164\145\x6e\x74"]["\x74\x6f\153\145\x6e"]))) { goto bo7fk; } goto c7cjj; CvxUh: $config["\x63\157\x6e\164\x65\156\164"] = json_decode($config["\x63\x6f\x6e\164\x65\156\x74"], true); goto fek1f; W18HX: if (!$config) { goto czlUL; } goto CvxUh; dNERk: $config = pdo_get("\x78\143\x5f\x62\x65\x61\x75\x74\171\137\143\x6f\x6e\146\x69\x67", array("\x78\x6b\145\171" => "\157\x6e\154\x69\156\145", "\165\x6e\151\141\143\151\x64" => $uniacid)); goto W18HX; BwNOS: load()->func("\x6c\x6f\147\x67\x69\x6e\x67"); goto BVdcO; chJqq: global $_W, $_GPC; goto CZfbd; T_Jh8: $online->check_server();