<?php
 class SignatureHelper { public function request($accessKeyId, $accessKeySecret, $domain, $params, $security = false) { goto piFCt; dKBp_: $sortedQueryStringTmp = ''; goto OCfhA; rJSmd: try { $content = $this->fetchContent($url); return json_decode($content); } catch (\Exception $e) { return false; } goto wWiJR; OCfhA: foreach ($apiParams as $key => $value) { $sortedQueryStringTmp .= "\46" . $this->encode($key) . "\x3d" . $this->encode($value); kSxfw: } goto hGvtS; XGlUv: $signature = $this->encode($sign); goto YF4Y4; piFCt: $apiParams = array_merge(array("\123\x69\x67\156\141\x74\x75\162\145\115\145\x74\x68\x6f\x64" => "\x48\115\101\x43\55\123\110\101\x31", "\123\x69\147\156\x61\x74\165\x72\x65\116\x6f\x6e\x63\x65" => uniqid(mt_rand(0, 0xffff), true), "\123\151\147\156\141\x74\x75\162\145\x56\x65\162\163\151\x6f\156" => "\x31\56\60", "\101\143\143\x65\163\x73\x4b\x65\x79\111\x64" => $accessKeyId, "\x54\151\155\145\x73\x74\141\155\160" => gmdate("\x59\55\x6d\55\144\x5c\124\x48\x3a\x69\72\x73\x5c\132"), "\106\157\162\155\141\x74" => "\112\123\117\x4e"), $params); goto Zvb4X; hGvtS: BjskT: goto oXyGQ; oXyGQ: $stringToSign = "\107\105\124\46\45\62\x46\46" . $this->encode(substr($sortedQueryStringTmp, 1)); goto Zj4QR; Zvb4X: ksort($apiParams); goto dKBp_; Zj4QR: $sign = base64_encode(hash_hmac("\163\x68\141\61", $stringToSign, $accessKeySecret . "\46", true)); goto XGlUv; YF4Y4: $url = ($security ? "\x68\x74\164\x70\163" : "\x68\164\x74\x70") . "\72\57\57{$domain}\x2f\x3f\123\x69\147\x6e\x61\x74\165\162\x65\75{$signature}{$sortedQueryStringTmp}"; goto rJSmd; wWiJR: } private function encode($str) { goto b5Ih7; TFL5o: $res = preg_replace("\57\45\x37\105\x2f", "\176", $res); goto GYQiT; mopdQ: $res = preg_replace("\57\x5c\x2a\x2f", "\x25\62\x41", $res); goto TFL5o; WZyy5: $res = preg_replace("\57\134\53\x2f", "\45\62\x30", $res); goto mopdQ; b5Ih7: $res = urlencode($str); goto WZyy5; GYQiT: return $res; goto YLk80; YLk80: } private function fetchContent($url) { goto hI00W; bTCRe: curl_setopt($ch, CURLOPT_HTTPHEADER, array("\170\x2d\x73\x64\153\55\x63\x6c\x69\x65\x6e\164" => "\x70\150\160\x2f\x32\x2e\x30\56\x30")); goto q4JQD; Sye7i: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto bTCRe; hI00W: $ch = curl_init(); goto RmDdc; ASTRZ: curl_setopt($ch, CURLOPT_TIMEOUT, 5); goto Sye7i; u_L66: curl_close($ch); goto v3JR3; RmDdc: curl_setopt($ch, CURLOPT_URL, $url); goto ASTRZ; lPV6R: $rtn = curl_exec($ch); goto w7Dq9; B85vY: GwRhx: goto lPV6R; gdXt0: sBZKm: goto u_L66; aT2zR: trigger_error("\x5b\103\x55\x52\114\x5f" . curl_errno($ch) . "\135\x3a\x20" . curl_error($ch), E_USER_ERROR); goto gdXt0; q4JQD: if (!(substr($url, 0, 5) == "\x68\x74\164\x70\x73")) { goto GwRhx; } goto qGMz0; nufoo: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto B85vY; v3JR3: return $rtn; goto E6Mkc; w7Dq9: if (!($rtn === false)) { goto sBZKm; } goto aT2zR; qGMz0: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto nufoo; E6Mkc: } }