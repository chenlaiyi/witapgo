<?php
 goto i1Umo; ElqiA: $config = pdo_get("\170\x63\x5f\x62\145\141\x75\x74\x79\x5f\x63\157\x6e\146\x69\x67", array("\x78\153\145\171" => "\x6f\x6e\154\151\x6e\145", "\x75\156\x69\x61\143\151\x64" => $uniacid)); goto lkobL; ySKkQ: vkzhy: goto thvPd; i1Umo: global $_W, $_GPC; goto UFyaD; lkobL: if (!$config) { goto KKG7h; } goto HS8vX; thvPd: KKG7h: goto QigUb; AtkYK: $token = ''; goto ElqiA; HS8vX: $config["\x63\157\156\164\x65\156\164"] = json_decode($config["\143\x6f\156\164\x65\156\x74"], true); goto fKWt6; DsFbw: class Online { public $token, $uniacid; public function __construct($token, $uniacid, $appid) { goto q_NCZ; oMXbp: $this->uniacid = $uniacid; goto SG72I; SG72I: $this->appid = $appid; goto XgiOs; q_NCZ: $this->token = $token; goto oMXbp; XgiOs: } public function check_server() { goto l3yHd; U5Ou3: goto jwO9X; goto U1Bwj; l3yHd: if (isset($_GET["\145\143\150\x6f\163\x74\162"])) { goto futIp; } goto JolTy; mEUz1: jwO9X: goto kp_uo; sdYWl: $this->valid(); goto mEUz1; U1Bwj: futIp: goto sdYWl; JolTy: $this->responseMsg(); goto U5Ou3; kp_uo: } public function valid() { goto Zq4__; r6BPJ: goto u6epB; goto m6bNf; czpIf: exit; goto r6BPJ; deyRS: echo $echoStr . "\53\x2b\53" . $this->token; goto czpIf; KkSPB: exit; goto KVfDO; Zq4__: $echoStr = $_GET["\x65\143\150\x6f\163\164\162"]; goto HG6AH; HG6AH: if ($this->checkSignature()) { goto x2OsE; } goto deyRS; KVfDO: u6epB: goto lyB4w; m6bNf: x2OsE: goto cGCKi; cGCKi: header("\x63\157\156\x74\145\x6e\164\x2d\x74\171\160\x65\72\x74\145\x78\164"); goto mAzVy; mAzVy: echo $echoStr; goto KkSPB; lyB4w: } private function checkSignature() { goto BG87D; y5Pob: $timestamp = $_GET["\x74\151\x6d\145\x73\164\x61\155\160"]; goto gvDNw; dxYbZ: npURu: goto pY0e6; SUiAS: $tmpStr = implode($tmpArr); goto UKTk2; IOKc1: goto npURu; goto eAG6Q; yPtHH: return true; goto dxYbZ; ZCKDR: $tmpArr = array($token, $timestamp, $nonce); goto HstTV; W5o_l: if ($tmpStr == $signature) { goto tEx7q; } goto xf_n1; NWZbA: $token = $this->token; goto ZCKDR; gvDNw: $nonce = $_GET["\156\157\156\143\x65"]; goto NWZbA; HstTV: sort($tmpArr, SORT_STRING); goto SUiAS; BG87D: $signature = $_GET["\x73\151\147\x6e\x61\164\165\162\145"]; goto y5Pob; UKTk2: $tmpStr = sha1($tmpStr); goto W5o_l; xf_n1: return false; goto IOKc1; eAG6Q: tEx7q: goto yPtHH; pY0e6: } public function responseMsg() { goto Ddhdo; EA3Re: goto m7GdD; goto zm3z6; bqlEB: a_5AW: goto PI4_I; zm3z6: c4w7S: goto IA3kx; vlVzp: goto m7GdD; goto fNqho; Ddhdo: $postStr = file_get_contents("\160\150\160\72\x2f\57\x69\156\x70\x75\164"); goto bGHrp; pYQOQ: goto m7GdD; goto ojR1Y; wowds: if (!empty($postArr["\x4d\x73\x67\124\x79\160\145"]) && $postArr["\115\x73\x67\x54\x79\160\145"] == "\151\155\x61\147\145") { goto yjAut; } goto MB_tS; dDffA: $data["\x75\x6e\151\x61\x63\x69\144"] = $this->uniacid; goto B_KWd; U4TZI: exit; goto T3SbR; chuSj: $data["\x75\x6e\151\x61\143\151\x64"] = $this->uniacid; goto fMRtm; IA3kx: m7GdD: goto ubL2X; AeqFw: exit; goto bqlEB; bGHrp: if (!empty($postStr) && is_string($postStr)) { goto sl2ZV; } goto bBA3i; g4ej2: sl2ZV: goto Awp_4; LQaBc: $this->checkOnline($data); goto vlVzp; NU1op: $data["\164\171\160\145"] = 1; goto lRdR_; WhG5c: $this->checkOnline($data); goto EA3Re; fMRtm: $data["\157\x70\145\156\151\144"] = $postArr["\106\162\x6f\155\125\163\145\x72\x4e\x61\x6d\x65"]; goto NU1op; SRKS3: if (!empty($postArr["\x4d\163\147\x54\x79\x70\145"]) && $postArr["\x4d\x73\147\124\x79\160\x65"] == "\x74\x65\x78\x74") { goto YwzHK; } goto wowds; T3SbR: goto a_5AW; goto g4ej2; YyCxB: $data["\x74\x79\160\145"] = 2; goto QZQOw; ojR1Y: YwzHK: goto chuSj; MB_tS: if ($postArr["\115\x73\x67\124\171\x70\x65"] == "\145\166\145\x6e\x74" && $postArr["\105\166\x65\x6e\164"] == "\x75\163\x65\162\137\x65\x6e\164\x65\162\x5f\164\145\155\x70\x73\145\163\163\151\x6f\x6e") { goto c4w7S; } goto pYQOQ; B_KWd: $data["\x6f\x70\x65\156\x69\144"] = $postArr["\106\x72\x6f\155\125\163\145\x72\x4e\x61\155\x65"]; goto YyCxB; bBA3i: echo ''; goto U4TZI; lRdR_: $data["\143\157\x6e\x74\x65\156\164"] = base64_encode($postArr["\103\157\156\x74\x65\156\x74"]); goto LQaBc; ubL2X: echo "\x73\x75\x63\x63\x65\x73\x73"; goto AeqFw; QZQOw: $data["\143\x6f\x6e\164\x65\x6e\x74"] = $postArr["\120\151\143\125\x72\154"]; goto WhG5c; Awp_4: $postArr = json_decode($postStr, true); goto SRKS3; fNqho: yjAut: goto dDffA; PI4_I: } public function checkOnline($data) { goto TOBLa; q8cBa: DYKym: goto UsQOy; AqvCj: pdo_insert("\170\x63\x5f\142\145\141\x75\x74\x79\x5f\x6f\156\154\x69\x6e\145\137\154\x6f\147", $data); goto Qw2HN; k3hIv: $config["\x63\x6f\x6e\x74\145\156\164"] = json_decode($config["\x63\157\156\164\145\156\164"], true); goto WfBMF; HVkST: $data["\x63\162\x65\x61\164\x65\x74\x69\155\145"] = date("\131\55\155\55\x64\x20\110\x3a\x69\x3a\x73"); goto NAKxP; x3oJO: $this->sendMon($data); goto DxE6o; ETWTn: K7xMn: goto Rri7f; BgGjB: if (!$request) { goto v2Q3S; } goto DflPY; HU3rG: $this->sendMon($data); goto q_g2Z; TOBLa: $online = pdo_get("\x78\x63\x5f\142\145\141\x75\164\171\x5f\x6f\x6e\x6c\151\156\x65\163", array("\x75\156\151\141\143\x69\x64" => $data["\165\156\x69\x61\143\151\144"], "\157\x70\x65\x6e\151\144" => $data["\157\160\145\156\151\x64"])); goto QNw0t; PohWJ: $request = pdo_insert("\170\x63\137\x62\x65\x61\165\x74\x79\137\x6f\x6e\154\151\156\145\x73", array("\165\156\x69\141\143\x69\144" => $data["\x75\156\151\141\143\151\144"], "\157\160\145\x6e\x69\x64" => $data["\x6f\x70\145\156\151\144"], "\155\x65\x6d\142\x65\x72" => 1, "\165\x70\144\141\164\145\164\x69\x6d\145" => date("\x59\55\155\55\144\x20\110\72\x69\72\x73"), "\164\x79\160\x65" => $data["\x74\171\160\145"], "\143\x6f\x6e\164\145\x6e\164" => $data["\143\x6f\156\x74\145\x6e\x74"], "\143\162\x65\x61\164\145\x74\151\155\x65" => date("\131\x2d\x6d\x2d\144\x20\110\72\151\x3a\163"))); goto BgGjB; Qw2HN: $this->sendMon($data); goto x6VXh; NAKxP: $request = pdo_insert("\170\x63\x5f\142\x65\x61\x75\x74\171\137\157\x6e\x6c\x69\156\x65\137\x6c\157\x67", $data); goto v8PQ0; DxE6o: goto gYVHo; goto HTcqz; JL8fI: if ($prev) { goto DHKoy; } goto x3oJO; DflPY: $data["\x70\x69\x64"] = pdo_insertid(); goto y6BSQ; tWshj: $prev = pdo_getall("\x78\x63\x5f\x62\145\x61\x75\x74\171\137\157\x6e\154\151\x6e\145\x5f\x6c\x6f\147", array("\x75\156\151\x61\143\x69\x64" => $data["\165\x6e\x69\x61\x63\x69\144"], "\x70\151\x64" => $data["\x70\151\144"], "\x64\165\x74\x79" => 2), array(), '', "\143\162\145\141\x74\145\164\151\x6d\145\x20\104\105\x53\103\x2c\x69\144\40\104\105\123\x43", array(1, 5)); goto JL8fI; Rri7f: rjja3: goto l2BwG; D82G7: if (!(time() - strtotime($prev[0]["\143\162\145\x61\x74\x65\164\151\x6d\145"]) >= intval($config["\143\157\156\164\x65\x6e\164"]["\x6a\x69\x61\x6e\x67\x65"]))) { goto v2ToC; } goto HU3rG; WfBMF: if (empty($config["\x63\x6f\x6e\x74\x65\x6e\x74"]["\x6a\151\141\x6e\x67\145"])) { goto K7xMn; } goto D82G7; MQMu6: $config = pdo_get("\170\143\137\142\145\x61\165\164\171\x5f\x63\157\x6e\146\151\147", array("\170\153\145\x79" => "\157\x6e\154\151\156\145", "\x75\156\x69\x61\143\151\x64" => $this->uniacid)); goto QXIAX; y6BSQ: $data["\x63\x72\145\141\164\145\x74\x69\x6d\145"] = date("\x59\55\x6d\55\144\x20\110\x3a\x69\72\163"); goto AqvCj; x6VXh: v2Q3S: goto Vfhbp; uSvTc: $sql = "\125\x50\x44\x41\124\x45\40" . tablename("\170\x63\137\142\x65\x61\x75\164\x79\x5f\x6f\156\154\151\x6e\145\163") . "\40\x53\x45\x54\40\x6d\x65\155\142\145\x72\75\x6d\145\155\142\x65\162\53\61\x2c\165\x70\144\141\x74\x65\x74\x69\x6d\145\x3d\x3a\x74\151\155\145\x73\54\x74\x79\x70\x65\75\x3a\164\171\160\x65\x2c\143\x6f\156\164\x65\x6e\x74\75\72\x63\x6f\156\164\145\x6e\x74\x20\127\110\x45\122\x45\x20\x69\144\x3d\x3a\x69\144\40\101\x4e\x44\40\165\x6e\x69\x61\143\x69\144\x3d\x3a\165\156\151\x61\143\151\x64"; goto R29Ev; q_g2Z: v2ToC: goto ETWTn; Jt5W8: $data["\160\151\x64"] = $online["\x69\144"]; goto HVkST; HTcqz: DHKoy: goto MQMu6; QXIAX: if (!$config) { goto rjja3; } goto k3hIv; bQ_7D: YRAD5: goto q8cBa; QNw0t: if ($online) { goto ZD4JO; } goto PohWJ; jBG01: ZD4JO: goto Jt5W8; v8PQ0: if (!$request) { goto YRAD5; } goto uSvTc; l2BwG: gYVHo: goto bQ_7D; Vfhbp: goto DYKym; goto jBG01; R29Ev: pdo_query($sql, array("\x3a\164\x69\x6d\x65\163" => date("\131\x2d\x6d\55\x64\x20\110\x3a\x69\72\x73"), "\72\x69\x64" => $online["\151\144"], "\x3a\x75\x6e\151\x61\x63\151\x64" => $data["\165\x6e\x69\141\x63\x69\x64"], "\72\164\x79\x70\145" => $data["\164\x79\x70\145"], "\72\x63\x6f\156\164\x65\156\164" => $data["\143\x6f\x6e\x74\x65\x6e\x74"])); goto tWshj; UsQOy: } public function sendMon($data) { goto D6hSh; pwRXN: $openids = $config["\x63\x6f\156\164\145\x6e\x74"]["\165\x73\x65\x72\154\x69\x73\x74"]; goto uY9bn; kCEy2: curl_setopt($ch, CURLOPT_HEADER, 0); goto U79Go; cPmwe: $pdata = curl_exec($ch); goto mFDxF; YvPGL: if (empty($config["\143\157\x6e\164\x65\x6e\x74"])) { goto KRLSm; } goto upotr; U6Q8a: $accessurl = $web["\143\157\156\x74\x65\x6e\x74"]["\x78\143\x6d\x65\163\x73\x61\147\145"] . "\x26\157\160\75\163\x65\156\x64\166\x32"; goto LRoEc; WQDGj: RsIpg: goto U6Q8a; D6hSh: $templateParam = array("\x77\145\x62\x6e\141\x6d\x65\x78" => "\xe6\227\xa0", "\156\151\143\153" => "\xe6\x97\xa0", "\143\157\156\164\145\x6e\x74" => "\xe6\x97\xa0", "\x61\160\x70\x69\x64" => $this->appid, "\x70\x61\x67\145" => "\x78\143\x5f\x62\145\141\x75\164\x79\57\x70\x61\x67\145\163\x2f\x62\x61\x73\x65\57\142\x61\x73\x65\x3f\x73\150\x61\x72\x65\75\57\170\x63\x5f\x62\x65\x61\x75\x74\171\x2f\165\x69\62\x2f\157\x6e\154\151\156\x65\57\151\156\x64\145\170"); goto k0drK; dsemh: $templateParam["\167\x65\x62\156\141\155\145\x78"] = $web["\143\157\156\164\145\x6e\x74"]["\x74\151\x74\x6c\145"]; goto LVTW9; i4c6K: if (!($config["\143\x6f\x6e\164\145\156\164"]["\162\x65\160\x6c\x79\137\x73\164\141\164\x75\x73"] == 1 && !empty($config["\x63\x6f\x6e\164\145\x6e\x74"]["\162\145\160\154\x79\x5f\143\x6f\x6e\164\145\156\164"]))) { goto KX7XO; } goto AQ5Bw; h2OKp: $templateParam["\156\x69\143\153"] = base64_decode($userinfo["\x6e\151\143\x6b"]); goto scPXH; scPXH: HjYtO: goto VxU76; HBrPx: goto NVwEp; goto D87Fe; uY9bn: $sendopenid = array(); goto rh9u8; U79Go: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto wf3LS; oHIJ2: momessv2($accessurl, $template, $sendopenid, $templateParam); goto i4c6K; QLP8w: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE); goto yZEuA; qlA9h: $template["\x64\141\164\141"] = $config["\x63\157\x6e\164\145\156\x74"]["\x64\x61\x74\x61"]; goto pwRXN; GMnOq: $web["\143\x6f\x6e\164\x65\x6e\x74"] = json_decode($web["\143\157\156\x74\x65\156\x74"], true); goto WQDGj; WaSEU: $ch = curl_init(); goto naPCd; wf3LS: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); goto QLP8w; DK8lq: $config["\143\x6f\x6e\164\145\x6e\164"] = json_decode($config["\143\x6f\x6e\164\145\156\x74"], true); goto YvPGL; KFC6y: $url = "\150\164\x74\160\163\x3a\57\x2f\141\x70\x69\x2e\167\145\151\170\151\x6e\56\161\x71\x2e\143\x6f\x6d\x2f\143\147\x69\x2d\142\151\156\x2f\155\145\x73\x73\141\x67\x65\57\143\x75\163\x74\x6f\x6d\57\163\x65\x6e\144\x3f\141\143\x63\x65\163\163\x5f\x74\x6f\153\145\x6e\75" . $token; goto BsyoS; AQ5Bw: $account_api = WeAccount::create(); goto Bq4v0; q_7si: $userinfo = pdo_get("\170\x63\137\142\x65\141\x75\x74\171\137\x75\x73\145\x72\151\x6e\146\157", array("\x75\x6e\151\141\143\x69\x64" => $this->uniacid, "\x6f\x70\x65\x6e\x69\144" => $data["\157\x70\145\156\151\x64"])); goto StZqj; A46mw: curl_setopt($ch, CURLOPT_POSTFIELDS, $postFields); goto cPmwe; StZqj: if (!($userinfo && !empty($userinfo["\156\151\x63\153"]))) { goto HjYtO; } goto h2OKp; upotr: $web = pdo_get("\170\x63\137\142\145\x61\165\164\171\137\143\x6f\156\146\151\147", array("\x78\x6b\x65\x79" => "\167\x65\x62", "\165\x6e\x69\x61\x63\151\144" => $data["\165\156\151\141\x63\x69\144"])); goto h7J3Q; k0drK: $config = pdo_get("\170\x63\137\x62\145\x61\165\164\171\137\x63\157\156\146\151\147", array("\170\153\145\x79" => "\157\156\x6c\x69\x6e\x65", "\165\156\151\141\143\x69\144" => $data["\165\x6e\151\141\143\151\x64"])); goto IDe8u; BsyoS: $data = array("\164\157\165\x73\x65\162" => $data["\157\x70\145\x6e\x69\x64"], "\155\163\x67\x74\x79\x70\145" => "\164\x65\x78\x74", "\164\145\x78\x74" => array("\x63\x6f\156\164\x65\x6e\164" => $config["\x63\157\156\164\145\x6e\x74"]["\162\x65\160\154\x79\137\143\x6f\x6e\164\145\156\164"])); goto Pjtd2; cArP5: WU8E2: goto q_7si; Bq4v0: $token = $account_api->getAccessToken(); goto KFC6y; Pjtd2: $postFields = json_encode($data, JSON_UNESCAPED_UNICODE); goto WaSEU; h7J3Q: if (!$web) { goto RsIpg; } goto GMnOq; pmacm: TOP3v: goto HAqa5; rB8Rz: $web["\x63\x6f\x6e\x74\145\x6e\x74"] = json_decode($web["\x63\x6f\156\x74\145\x6e\x74"], true); goto HXSdp; LVTW9: MJUC8: goto cArP5; HAqa5: $web = pdo_get("\x78\x63\x5f\142\x65\x61\x75\164\x79\x5f\x63\x6f\x6e\x66\x69\147", array("\170\153\145\x79" => "\167\x65\142", "\165\x6e\151\141\x63\x69\144" => $this->uniacid)); goto u4FlZ; HXSdp: if (!(!empty($web["\143\x6f\156\x74\145\156\164"]) && !empty($web["\x63\x6f\156\164\x65\x6e\x74"]["\x74\x69\164\x6c\145"]))) { goto MJUC8; } goto dsemh; niNVx: KRLSm: goto RAA2P; IDe8u: if (!$config) { goto HMRZE; } goto DK8lq; kjntO: NVwEp: goto oHIJ2; Y_xpw: KX7XO: goto niNVx; yZEuA: curl_setopt($ch, CURLOPT_POST, true); goto A46mw; rh9u8: foreach ($openids as $itemopenis) { $sendopenid[] = $itemopenis["\157\x70\x65\156\151\x64"]; MP0BZ: } goto pmacm; u4FlZ: if (!$web) { goto WU8E2; } goto rB8Rz; q6oGN: xXuNx: goto HBrPx; slA0F: $templateParam["\x63\157\156\164\145\x6e\x74"] = "\xe5\x9b\xbe\347\x89\207"; goto q6oGN; LRoEc: $template = $config["\x63\x6f\156\x74\x65\x6e\164"]["\x78\x63"]; goto qlA9h; naPCd: curl_setopt($ch, CURLOPT_URL, $url); goto kCEy2; tvAn5: if (!($data["\164\x79\160\145"] == 2)) { goto xXuNx; } goto slA0F; D87Fe: HP6FD: goto vUQvl; RAA2P: HMRZE: goto EmFiC; vUQvl: $templateParam["\x63\157\156\164\145\156\x74"] = base64_decode($data["\x63\157\x6e\164\145\x6e\164"]); goto kjntO; mFDxF: curl_close($ch); goto Y_xpw; VxU76: if ($data["\164\171\x70\145"] == 1) { goto HP6FD; } goto tvAn5; EmFiC: } } goto AtkYK; fKWt6: if (!(!empty($config["\143\157\x6e\x74\145\156\x74"]) && !empty($config["\x63\157\x6e\164\145\156\164"]["\x74\157\x6b\145\156"]))) { goto vkzhy; } goto Fsb7p; koxSn: load()->func("\x6c\157\147\147\151\156\x67"); goto DsFbw; Fsb7p: $token = $config["\x63\157\156\164\145\x6e\164"]["\x74\x6f\x6b\145\156"]; goto ySKkQ; UFyaD: $uniacid = $_W["\x75\156\151\x61\143\151\144"]; goto koxSn; QigUb: $online = new Online($token, $uniacid, $_W["\141\143\x63\157\165\156\164"]["\153\x65\171"]); goto qguvW; qguvW: $online->check_server();