<!DOCTYPE html>
<html lang="zh-cn">
{template 'store/common/header'}
<link rel="stylesheet" href="{__PLUGIN__}/validform/5.3.2/Validform.css">
<link href="{MODULE_URL}resource/mobile/plugin/css/common.min.css?v=20170802" rel="stylesheet">
<style type="text/css">
    .input_item {width: 25%;}
    /**定义编辑器冲突样式**/
    .Eleditor-area{min-height: 200px;}
    .Eleditor-controller{z-index:2;}
    .Eleditor-controller .webuploader-pick{color:#000;}
    .Eleditor-controller ul li{padding:0 0 0 10%;border-bottom: 1px solid #ddd !important;}
    .Eleditor-textEditor{z-index:3;}
    #contentEditor_miaoshu img,#contentEditor_shop img,#contentEditor_rule img,#contentEditor_goods img,#contentEditor5 img{  width: 100%;  }
    .Eleditor-controller{  z-index: 30;  }
    .Eleditor-textStyle .Eleditor-textStyle-item-upImg{  display: none;  }
    /*提示code颜色*/
    .publish code {color: #c7254e;}
</style>
<script src="{__MOBILE_STORE_JS__}/Eleditor.min.js"></script>
<script src="{__MOBILE_STORE_JS__}/webuploader.min.js"></script>
<script src="{__PLUGIN__}/artTemplate/template-native-debug.js"></script>
<script type="text/javascript" src="{MODULE_URL}resource/mobile/plugin/js/app/util.js"></script>
<script type="text/javascript" src="{MODULE_URL}resource/mobile/plugin/js/require.js"></script>
<script type="text/javascript" src="{MODULE_URL}resource/mobile/plugin/js/lib/mui.min.js"></script>
<script type="text/javascript" src="{MODULE_URL}resource/mobile/plugin/js/app/common.js"></script>
<script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=F51571495f717ff1194de02366bb8da9&s=1"></script>
<body class="bgf2">
<form action="{php echo $this->createMobileUrl('store.obj_tiger_prize',array('act'=>'modify','aid' => $aid));}" id="form_content" method="post">
    <section class="bgfff pt20">
        <ul class="publish">
            <li class="float">
                <p>奖品名称</p>
                <section class="form_con selectBox">
                    <input class="form_float_txt" datatype="*" id="name" maxlength="100"
                           name="model[name]" nullmsg="请输入奖品名称！" placeholder="请输入奖品名称"
                           type="text" value="{$model['name']}"/>
                </section>
            </li>
            <li>
                <p>奖项图标<span></span></p>
                <section class="form_con clearfix">
                    <div class="mui-input-cell">
                        {php echo tpl_app_form_field_image('icon',$model['icon'] ,false);}
                    </div>
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong>  图标建议尺寸48x48像素，采用PNG格式
                </section>
            </li>
            <li>
                <p>奖品类型<span></span></p>
                <section class="form_con clearfix">
                    <div class="mui-input-cell">
                        <section class="input_item">
                            <input type="radio" value="0" name="model[types]" id="types0" class="types" {if $model['types']==0} checked {/if}>
                            <label for="types0"></label>
                            <span>谢谢参与</span>
                        </section>
                        <section class="input_item">
                            <input type="radio" value="1" name="model[types]" id="types1" class="types" {if $model['types']==1} checked {/if}>
                            <label for="types1"></label>
                            <span>账户积分</span>
                        </section>
                        <section class="input_item">
                            <input type="radio" value="2" name="model[types]" id="types2" class="types" {if $model['types']==2} checked {/if}>
                            <label for="types2"></label>
                            <span>账户余额</span>
                        </section>
                        <section class="input_item">
                            <input type="radio" value="3" name="model[types]" id="types3" class="types" {if $model['types']==3} checked {/if}>
                            <label for="types3"></label>
                            <span>微信红包</span>
                        </section>
                        <section class="input_item">
                            <input type="radio" value="4" name="model[types]" id="types4" class="types" {if $model['types']==4} checked {/if}>
                            <label for="types4"></label>
                            <span>实物商品</span>
                        </section>
                        <section class="input_item">
                            <input type="radio" value="5" name="model[types]" id="types5" class="types" {if $model['types']==5} checked {/if}>
                            <label for="types5"></label>
                            <span>商家卡券</span>
                        </section>
                    </div>
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong><br>
                </section>
            </li>

            <li class="float" id="prize_types0" style="display: {if $model['types'] != 0} none{/if};">
                <p>奖品数量</p>
                <section class="form_con selectBox">
                    <input class="form_float_txt"  type="number" datatype="n" maxlength="10" name="model[interim][thinks_create_num]" value="{php echo $model['types']==0 ? $model['number']:'0'}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="请输入奖品数量！" placeholder="请输入奖品数量">
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong> 请输入活动生成活动奖品的数量 单位：个
                </section>
            </li>

            <div id="prize_types1" style="display: {if $model['types'] != 1} none{/if};">
                <li>
                    <p>创建方式<span></span></p>
                    <section class="form_con clearfix">
                        <div class="mui-input-cell">
                            <section class="input_item">
                                <input type="radio" value="0" name="model[interim][score_create_types]" id="score_create_types0" class="score_create_types" {if $model['create_types']==0} checked {/if}>
                                <label for="score_create_types0"></label>
                                <span>固定</span>
                            </section>
                            <section class="input_item">
                                <input type="radio" value="1" name="model[interim][score_create_types]" id="score_create_types1" class="score_create_types" {if $model['create_types']==1} checked {/if}>
                                <label for="score_create_types1"></label>
                                <span>随机</span>
                            </section>
                        </div>
                    </section>
                    <section class="font26 c9 lh15">
                        <strong>提示：</strong> 固定和随机为生成奖品的两种方式，用户可根据活动场景自行选择生成方式。
                    </section>
                </li>
                <div id="score_create_types0_box" style="display: {if $model['create_types'] != 0} none{/if};">
                    <li class="float">
                        <p>积分数量</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" step="1" max="1000"  maxlength="10" name="model[score]" value="{$model['score']}" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" placeholder="请输入积分数量">
                        </section>
                    </li>
                </div>
                <div id="score_create_types1_box" style="display: {if $model['create_types'] != 1} none{/if};">
                    <li class="float">
                        <p>最小额度</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" step="1" max="1000"  maxlength="10" name="model[interim][min_score]" value="{php echo $model['types']==1 && $model['create_types']==1 ? intval($model['min_score']):'1'}" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" placeholder="请输入积分数量">
                        </section>
                    </li>
                    <li class="float">
                        <p>最大额度</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" step="1" max="1000"  maxlength="10" name="model[interim][max_score]" value="{php echo $model['types']==1 && $model['create_types']==1 ? intval($model['max_score']):'1000'}" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" placeholder="请输入积分数量">
                        </section>
                        <section class="font26 c9 lh15">
                            <strong>提示：</strong> 积分将随机生成，金额由“最小额度”和“最大额度”限制（单位：积分） 注意：奖品最小为1积分 最大1000积分
                        </section>
                    </li>
                </div>
                <li class="float">
                    <p>奖品数量</p>
                    <section class="form_con selectBox">
                        <input class="form_float_txt"  type="number" datatype="n"  maxlength="10" name="model[interim][score_create_num]" value="{php echo $model['types']==1 ? $model['number']:'0'}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="请输入奖品数量！" placeholder="请输入奖品数量">
                    </section>
                    <section class="font26 c9 lh15">
                        <strong>提示：</strong> 请输入生成活动奖品的数量 单位：个
                    </section>
                </li>
            </div>

            <div id="prize_types2" style="display: {if $model['types'] != 2} none{/if};">
                <li>
                    <p>创建方式<span></span></p>
                    <section class="form_con clearfix">
                        <div class="mui-input-cell">
                            <section class="input_item">
                                <input type="radio" value="0" name="model[interim][sys_create_types]" id="sys_create_types0" class="sys_create_types" {if $model['create_types']==0} checked {/if}>
                                <label for="sys_create_types0"></label>
                                <span>固定</span>
                            </section>
                            <section class="input_item">
                                <input type="radio" value="1" name="model[interim][sys_create_types]" id="sys_create_types1" class="sys_create_types" {if $model['create_types']==1} checked {/if}>
                                <label for="sys_create_types1"></label>
                                <span>随机</span>
                            </section>
                        </div>
                    </section>
                    <section class="font26 c9 lh15">
                        <strong>提示：</strong> 固定和随机为生成奖品的两种方式，用户可根据活动场景自行选择生成方式。
                    </section>
                </li>
                <div id="sys_create_types0_box" style="display: {if $model['create_types'] != 0} none{/if};">
                    <li class="float">
                        <p>账户余额</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" step="0.01" max="1000"  maxlength="10" name="model[sys]" value="{$model['sys']}" onkeyup="if(isNaN(this.value)){this.value='0.00';}else{this.value}" onblur = "this.value=FloatMoney(this.value)" placeholder="请输入账户余额">
                        </section>
                        <section class="font26 c9 lh15">
                            <strong>提示：</strong> 请先确认您的账户余额充足，避免出现补发红包的情况。账户余额不足请充值 <a href="{php echo $this->createMobileUrl('store.store_recharge',array('act'=>'index'))}">【账户充值】</a>
                        </section>
                    </li>
                </div>
                <div id="sys_create_types1_box" style="display: {if $model['create_types'] != 1} none{/if};">
                    <li class="float">
                        <p>最小额度</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" step="0.01" max="1000"  maxlength="10" name="model[interim][min_sys]" value="{php echo $model['types']==2 && $model['create_types']==1 ? $model['min_sys']:'0.01'}" onkeyup="if(isNaN(this.value)){this.value='0.00';}else{this.value}" onblur = "this.value=FloatMoney(this.value)" placeholder="请输入账户余额">
                        </section>
                    </li>
                    <li class="float">
                        <p>最大额度</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" step="0.01" max="1000"  maxlength="10" name="model[interim][max_sys]" value="{php echo $model['types']==2 && $model['create_types']==1 ? $model['max_sys']:'1000'}" onkeyup="if(isNaN(this.value)){this.value='0.00';}else{this.value}" onblur = "this.value=FloatMoney(this.value)" placeholder="请输入账户余额">
                        </section>
                        <section class="font26 c9 lh15">
                            <strong>提示：</strong> 账户余额将随机生成，金额由“最小额度”和“最大额度”限制（单位：积分） 注意：金额最小为0.01元 最大1000元
                        </section>
                        <section class="font26 c9 lh15">
                            <strong>提示：</strong> 请先确认您的账户余额充足，避免出现补发红包的情况。账户余额不足请充值 <a href="{php echo $this->createMobileUrl('store.store_recharge',array('act'=>'index'))}">【账户充值】</a>
                        </section>
                    </li>
                </div>
                <li class="float">
                    <p>奖品数量</p>
                    <section class="form_con selectBox">
                        <input class="form_float_txt"  type="number" datatype="n"  maxlength="10" name="model[interim][sys_create_num]" value="{php echo $model['types']==2 ? $model['number']:'0'}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="请输入奖品数量！" placeholder="请输入奖品数量">
                    </section>
                    <section class="font26 c9 lh15">
                        <strong>提示：</strong> 请输入生成活动奖品的数量 单位：个
                    </section>
                </li>
            </div>

            <div id="prize_types3" style="display: {if $model['types'] != 3} none{/if};">
                <li>
                    <p>创建方式<span></span></p>
                    <section class="form_con clearfix">
                        <div class="mui-input-cell">
                            <section class="input_item">
                                <input type="radio" value="0" name="model[interim][money_create_types]" id="money_create_types0" class="money_create_types" {if $model['create_types']==0} checked {/if}>
                                <label for="money_create_types0"></label>
                                <span>固定</span>
                            </section>
                            <section class="input_item">
                                <input type="radio" value="1" name="model[interim][money_create_types]" id="money_create_types1" class="money_create_types" {if $model['create_types']==1} checked {/if}>
                                <label for="money_create_types1"></label>
                                <span>随机</span>
                            </section>
                        </div>
                    </section>
                    <section class="font26 c9 lh15">
                        <strong>提示：</strong> 固定和随机为生成奖品的两种方式，用户可根据活动场景自行选择生成方式。
                    </section>
                </li>
                <div id="money_create_types0_box" style="display: {if $model['create_types'] != 0} none{/if};">
                    <li class="float">
                        <p>红包金额</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" step="0.01" max="1000"  maxlength="10" name="model[money]" value="{$model['money']}" onkeyup="if(isNaN(this.value)){this.value='0.00';}else{this.value}" onblur = "this.value=FloatMoney(this.value)" placeholder="请输入红包金额">
                        </section>
                    </li>
                </div>
                <div id="money_create_types1_box" style="display: {if $model['create_types'] != 1} none{/if};">
                    <li class="float">
                        <p>最小额度</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" min="0.3" max="1000" step="0.01"  maxlength="10" name="model[interim][min_money]" value="{php echo $model['types']==3 && $model['create_types']==1 ? $model['min_money']:'0.30'}" onkeyup="if(isNaN(this.value)){this.value='0.00';}else{this.value}" onblur = "this.value=FloatMoney(this.value)" placeholder="请输入红包金额">
                        </section>
                    </li>
                    <li class="float">
                        <p>最大额度</p>
                        <section class="form_con selectBox">
                            <input class="form_float_txt" type="number" min="0.3" max="1000" step="0.01"  maxlength="10" name="model[interim][max_money]" value="{php echo $model['types']==3 && $model['create_types']==1 ? $model['max_money']:'1000'}" onkeyup="if(isNaN(this.value)){this.value='0.00';}else{this.value}" onblur = "this.value=FloatMoney(this.value)" placeholder="请输入红包金额">
                        </section>
                        <section class="font26 c9 lh15">
                            <strong>提示：</strong> 红包金额将随机生成，金额由“最小额度”和“最大额度”限制（单位：积分） 注意：红包最小为0.3元 最大1000元
                        </section>
                    </li>
                </div>
                <li class="float">
                    <p>奖品数量</p>
                    <section class="form_con selectBox">
                        <input class="form_float_txt"  type="number" datatype="n"  maxlength="10" name="model[interim][money_create_num]" value="{php echo $model['types']==3 ? $model['number']:'0'}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="请输入奖品数量！" placeholder="请输入奖品数量">
                    </section>
                    <section class="font26 c9 lh15">
                        <strong>提示：</strong> 请输入生成活动奖品的数量 单位：个
                    </section>
                </li>
            </div>

            <div id="prize_types4" style="display: {if $model['types'] != 4} none{/if};">
                <li class="float">
                    <p>奖品数量</p>
                    <section class="form_con selectBox">
                        <input class="form_float_txt"  type="number" datatype="n"  maxlength="10" name="model[interim][product_create_num]" value="{php echo $model['types']==4 ? $model['number']:'0'}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="请输入奖品数量！" placeholder="请输入奖品数量">
                    </section>
                    <section class="font26 c9 lh15">
                        <strong>提示：</strong> 请输入生成活动奖品的数量 单位：个
                    </section>
                </li>
                <li>
                    <p>商品详情<span></span></p>
                    <section class="form_con clearfix">
                        <section class="txt_item">
                            <textarea rows = "3" name="model[content]" id="content" class="form_area" style="display: none;" placeholder = "请输入商品详情..." >{$model['content']}</textarea>
                            <div id="contentEditor"></div>
                        </section>
                    </section>
                </li>
                <li>
                    <p>发放形式<span></span></p>
                    <section class="form_con clearfix">
                        <div class="mui-input-cell">
                            <section class="input_item">
                                <input type="radio" value="0" name="model[writeoff_types]" id="writeoff_types0" {if $model['writeoff_types']==0} checked {/if}>
                                <label for="writeoff_types0"></label>
                                <span>线下核销</span>
                            </section>
                            <section class="input_item">
                                <input type="radio" value="1" name="model[writeoff_types]" id="writeoff_types1" {if $model['writeoff_types']==1} checked {/if}>
                                <label for="writeoff_types1"></label>
                                <span>线上发货</span>
                            </section>
                        </div>
                    </section>
                </li>
            </div>

            <div id="prize_types5" style="display: {if $model['types'] != 5} none{/if};">
                <li class="float">
                    <p>商家卡券</p>
                    <section class="form_con selectBox">
                        <select id="card_id" name="model[card_id]" class="font28">
                            <option value="">请选择</option>
                            {loop $cardList $card}
                            <option value="{$card['id']}" {if $card['id'] == $model['card_id']} selected="selected"{/if}>{$card['name']}</option>
                            {/loop}
                        </select>
                    </section>
                </li>
                <li class="float">
                    <p>奖品数量</p>
                    <section class="form_con selectBox">
                        <input class="form_float_txt"  type="number" datatype="n"  maxlength="10" name="model[interim][card_create_num]" value="{php echo $model['types']==5 ? $model['number']:'0'}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="请输入奖品数量！" placeholder="请输入奖品数量">
                    </section>
                    <section class="font26 c9 lh15">
                        <strong>提示：</strong> 请输入生成活动奖品的数量 单位：个
                    </section>
                </li>
            </div>

            <li class="float">
                <p>剩余数量</p>
                <section class="form_con selectBox">
                    <input class="form_float_txt"  type="number" datatype="n"  maxlength="10" name="model[surplus]" value="{$model['surplus']}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="请输入剩余奖品数量！" placeholder="请输入剩余奖品数量">
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong> 添加时请填写奖品数量，用户中奖后会自动递减到0为止，则该奖品不会再出现。
                </section>
            </li>
            <li class="float">
                <p>中奖概率</p>
                <section class="form_con selectBox">
                    <input class="form_float_txt"  type="number" datatype="n"  maxlength="10" name="model[odds]" value="{$model['odds']}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="请输入奖项中奖概率！" placeholder="请输入奖项中奖概率">
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong> 奖项的几率总合等于100则百分比，等于1000则千分比以此类推。
                </section>
            </li>
            <li>
                <p>奖品封面<span></span></p>
                <section class="form_con clearfix">
                    <div class="mui-input-cell">
                        {php echo tpl_app_form_field_image('picurl',$model['picurl'] ,false);}
                    </div>
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong>  图标建议尺寸200x200像素，将展示在中奖页面
                </section>
            </li>
            <li>
                <p>中奖限制<span></span></p>
                <section class="form_con clearfix">
                    <div class="mui-input-cell">
                        <section class="input_item">
                            <input type="radio" value="2" name="model[limittypes]" id="limittypes2" class="limittypes" {if $model['limittypes']==2} checked {/if}>
                            <label for="limittypes2"></label>
                            <span>不做限制</span>
                        </section>
                        <section class="input_item">
                            <input type="radio" value="0" name="model[limittypes]" id="limittypes0" class="limittypes" {if $model['limittypes']==0} checked {/if}>
                            <label for="limittypes0"></label>
                            <span>活动期间</span>
                        </section>
                        <section class="input_item">
                            <input type="radio" value="1" name="model[limittypes]" id="limittypes1" class="limittypes" {if $model['limittypes']==1} checked {/if}>
                            <label for="limittypes1"></label>
                            <span>活动每天</span>
                        </section>
                    </div>
                </section>
            </li>
            <li class="float" id="limittypes_box" style="display: {if $model['limittypes'] == 2} none{/if};">
                <p>中奖次数</p>
                <section class="form_con selectBox">
                    <input class="form_float_txt"  type="number" maxlength="10" name="model[limitnum]" value="{$model['limitnum']}" onkeyup="if(isNaN(this.value)) this.value='0';" placeholder="请输入奖品默认领取次数">
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong> 请输入奖品默认领取次数 设置后该奖品会限制用户中奖数量。
                </section>
            </li>
            <li  style="display: {if $config['sms_obj']!=1}none{/if};">
                <p>短信提醒<span></span></p>
                <section class="form_con clearfix">
                    <div class="mui-input-cell">
                        <section class="input_item">
                            <input type="radio" value="0" name="model[is_sms]" id="is_sms0" class="is_sms" {if $model['is_sms']==0} checked {/if}>
                            <label for="is_sms0"></label>
                            <span>关闭</span>
                        </section>
                        <section class="input_item">
                            <input type="radio" value="1" name="model[is_sms]" id="is_sms1" class="is_sms" {if $model['is_sms']==1} checked {/if}>
                            <label for="is_sms1"></label>
                            <span>开启</span>
                        </section>
                    </div>
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong> 开启前请确保账户短信数量充足，短信不足将造成短信发送失败。
                </section>
            </li>
            <li id="is_sms_box" style="display: {if $model['is_sms'] == 0} none{/if};">
                <p>短信模板<span></span></p>
                <section class="form_con clearfix">
                    <section class="txt_item">
                        <textarea style="width:100%" rows = "3" name="model[sms_tmp]" id="sms_tmp" class="form_area" placeholder = "请输入中奖短信模板"  >{$model['sms_tmp']}</textarea>
                    </section>
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong> 请根据实际活动需求创建短信模板，系统提供标签将会在发送过程中自动替换。<code onclick="insertAtCursor('sms_tmp',this);">{{PRIZE}}</code>奖品名称 <code onclick="insertAtCursor('sms_tmp',this);">{{NICKNAME}}</code>微信昵称 <code onclick="insertAtCursor('sms_tmp',this);">{{OBJ}}</code>活动名称 <code onclick="insertAtCursor('sms_tmp',this);">{{WRITEOFFCODE}}</code>核销码
                </section>
            </li>
            <li class="float">
                <p>奖品排序</p>
                <section class="form_con selectBox">
                    <input class="form_float_txt"  type="number" datatype="n" id="sort" maxlength="10" name="model[sort]" value="{$model['sort']}" onkeyup="if(isNaN(this.value)) this.value='0';" nullmsg="信息排序必须填写！" placeholder="请输入数字 数字越小越靠前">
                </section>
                <section class="font26 c9 lh15">
                    <strong>提示：</strong> 请输入数字 数字越小越靠前。
                </section>
            </li>
            <li>
                <p>奖品状态</p>
                <section class="form_con rel">
                    <section class="font26 c9 form_tips">选择信息开启/关闭状态，关闭后该信息将被禁用</section>
                    <span class="switch {if $model['status']==1}switch_on{else}switch_off{/if}">
                    <i class="slider"></i>
                    <input type="hidden" name="model[status]" value="{$model['status']}"/>
                    </span>
                </section>
            </li>
        </ul>
    </section>
    <section class="h24"></section>
    <section class="buttonBox">
        <section class="buttonFloat clickBtn">
            <input id="id" name="id" type="hidden" value="{$model['id']}"/>
            <input type="hidden" name="token" value="{$_W['token']}"/>
            <input type="hidden" name="submit" value="submit"/>
            <a href="{php echo $this->createMobileUrl('store.obj_tiger_prize',array('act'=>'index','aid'=>$aid))}" class="db font32" style="width: 50%;    float: left;   color: #fff;   border-radius: 0.6rem 0 0 0.6rem;    background: #f92f4a;">返回列表</a>
            <button type="submit" id="SubmitBtn" style="width: 50%;   float: left;    background: #FFD112;    color: #0e0e0e;border-radius: 0 0.6rem 0.6rem 0;">确认提交</button>
        </section>
    </section>
</form>
<script>
    // 实例化 编辑器
    var artEditor = new Eleditor({
        el: "#contentEditor",
        upload:{
            server: "{php echo $this->createMobileUrl('file',array('act'=>'upload','type'=>'image','thumb'=>0));}",
            formData: {
                'module':"umiacp_bargain",
            },
            accept: {
                title: 'Images',
                extensions: 'gif,jpg,jpeg,bmp,png,webp',
                mimeTypes: 'image/*'
            },
            compress: false,
            fileSizeLimit: 2
        },
    });
    // 初始化编辑器内容
    artEditor.append($("#content").val());
</script>
<script>
    $(function(){
        require(['{__PLUGIN__}/validform/5.3.2/Validform_v5.3.2_min.js'], function () {
            //为formContent 添加验证事件
            $("#form_content").Validform({
                tiptype: function (msg, o, cssctl) {
                    if (!o.obj.is("form")) {
                        if (o.type == 2) {
                            //loading带文字
                            layer.open({
                                type: 2
                                , content: '数据提交中'
                                , time: 999 //999秒后自动关闭
                            });
                        } else {
                            layer.closeAll();
                            layer.open({
                                content: msg
                                , skin: 'msg'
                                , time: 2 //2秒后自动关闭
                                , style: 'bottom:0;'
                            });
                        }
                    }
                },
                ajaxPost: true,
                tipSweep: true,
                beforeSubmit: function (curform) {
                    //赋值编辑器内容
                    $("#content").val(artEditor.getContent());
                    $("#SubmitBtn").attr("disabled", true);
                },
                callback: function (data) {
                    layer.closeAll();
                    if(data.status == 1){
                        layer.open({
                            content: data.msg
                            , skin: 'msg'
                            , time: 2 //2秒后自动关闭
                            , style: 'bottom:0;'
                        });

                        setTimeout(function () {
                            window.location.href = "{php echo $this->createMobileUrl('store.obj_tiger_prize',array('act'=>'index','aid' => $aid));}";
                        }, 2000);

                    }else{
                        layer.open({
                            content: data.msg
                            , skin: 'msg'
                            , time: 2 //2秒后自动关闭
                            , style: 'bottom:0;'
                        });
                        $("#SubmitBtn").attr("disabled", false);
                    }
                }
            });
        });


        //奖品类型切换
        $('.types').change(function() {
            layer.closeAll();
            var types = $(this).val();
            for (var i = 0; i < 6; i++) {
                if (i == types) {
                    $("#prize_types" + i).show();
                }
                else {
                    $("#prize_types" + i).hide();
                }
            }
            if(types==2||types==3)
            {
                layer.open({
                    content: '设置此奖项前请确认您的账户余额是否充足，余额不足将导致奖品发送失败！'
                    , skin: 'msg'
                    , time: 5 //3秒后自动关闭
                });
            }
        });

        //积分类型切换
        $('.score_create_types').change(function(){
            var score_create_types = $(this).val();
            if (score_create_types==0)
            {
                $("#score_create_types0_box").show();
                $("#score_create_types1_box").hide();
            }
            else
            {
                $("#score_create_types0_box").hide();
                $("#score_create_types1_box").show();
            }
        });
        //余额类型切换
        $('.sys_create_types').change(function(){
            var sys_create_types = $(this).val();
            if (sys_create_types==0)
            {
                $("#sys_create_types0_box").show();
                $("#sys_create_types1_box").hide();
            }
            else
            {
                $("#sys_create_types0_box").hide();
                $("#sys_create_types1_box").show();
            }
        });
        //红包类型切换
        $('.money_create_types').change(function(){
            var money_create_types = $(this).val();
            if (money_create_types==0)
            {
                $("#money_create_types0_box").show();
                $("#money_create_types1_box").hide();
            }
            else
            {
                $("#money_create_types0_box").hide();
                $("#money_create_types1_box").show();
            }
        });

        //中奖限制切换
        $('.limittypes').change(function(){
            var types = $(this).val();
            if(types == 2)
            {
                $("#limittypes_box").hide();
            }
            else
            {
                $("#limittypes_box").show();
            }
        });
        //短信提醒切换
        $('.is_sms').change(function(){
            var is_sms = $(this).val();
            if(is_sms == 0)
            {
                $("#is_sms_box").hide();
            }
            else
            {
                $("#is_sms_box").show();
            }
        });

        $(".switch").click(function(e) {
            if($(this).hasClass("switch_on")){
                $(this).removeClass("switch_on");
                $(this).addClass("switch_off");
                $(this).find("input").val(0);
            }
            else{
                $(this).removeClass("switch_off");
                $(this).addClass("switch_on");
                $(this).find("input").val(1);
            }
        });

    });
    //光标处插入指定文本内容
    function insertAtCursor(text, obj) {
        var myField = document.getElementById(text);
        var myValue = obj.innerHTML;
        if (document.selection) {
            //IE support
            myField.focus();
            sel = document.selection.createRange();
            sel.text = myValue;
            sel.select();
        } else if (myField.selectionStart || myField.selectionStart == '0') {
            //MOZILLA/NETSCAPE support
            var startPos = myField.selectionStart;
            var endPos = myField.selectionEnd;
            var beforeValue = myField.value.substring(0, startPos);
            var afterValue = myField.value.substring(endPos, myField.value.length);

            myField.value = beforeValue + myValue + afterValue;

            myField.selectionStart = startPos + myValue.length;
            myField.selectionEnd = startPos + myValue.length;
            myField.focus();
        } else {
            myField.value += myValue;
            myField.focus();
        }
    }
</script>
</body>
</html>
