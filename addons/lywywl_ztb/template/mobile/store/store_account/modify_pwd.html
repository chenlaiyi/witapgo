<!doctype html>
<html>
{template 'store/common/header'}
<!--CSS-->
<link rel="stylesheet" href="{__PLUGIN__}/validform/5.3.2/Validform.css">

<body class="bgf2">
<!--中心区域-->
<section class="mt24">
    <form id="modify_pwd" method="post">
        <ul class="registerList">
            <li>
                <input class="regInput font32" type="password" placeholder="请输入原密码" name="model[oldpassword]" maxlength="16" datatype="*6-16" nullmsg="请输入原密码！" errormsg="密码范围在6~16位之间！">
            </li>
            <li>
                <input class="regInput font32" type="password" placeholder="请输入新密码（6-16字母和数字组合）" name="model[password]" maxlength="16" datatype="*6-16" nullmsg="请输入新密码！" errormsg="密码范围在6~16位之间！">
            </li>
            <li>
                <input class="regInput font32" type="password"  placeholder="请输入确认密码" name="model[password2]" maxlength="16" datatype="*" recheck="model[password]" nullmsg="请输入确认密码！" errormsg="您两次输入的密码不一致！">
            </li>
        </ul>
        <section class="btn-de">
            <input name="token" value="{$_W['token']}" type="hidden" />
            <input type="hidden" name="submit" value="submit"/>
            <button type="submit" class="Button" id="SubmitBtn">确认提交</button>
        </section>
    </form>
</section>
<script src="{__PLUGIN__}/validform/5.3.2/Validform_v5.3.2_min.js"></script>
<script>
    $(function(){
        //为formContent 添加验证事件
        $("#modify_pwd").Validform({
            tiptype: function (msg, o, cssctl) {
                if (!o.obj.is("form")) {
                    if (o.type == 2) {
                        //loading带文字
                        layer.open({
                            type: 2
                            , content: '数据提交中'
                            , time: 999 //999秒后自动关闭
                        });
                    } else {
                        layer.closeAll();
                        layer.open({
                            content: msg
                            , skin: 'msg'
                            , time: 2 //2秒后自动关闭
                            , style: 'bottom:0;'
                        });
                    }
                }
            },
            ajaxPost: true,
            tipSweep: true,
            beforeSubmit: function (curform) {
                $("#SubmitBtn").attr("disabled", true);
            },
            callback: function (data) {
                layer.closeAll();
                if(data.status == 1){
                    layer.open({
                        content: data.msg
                        , skin: 'msg'
                        , time: 2 //2秒后自动关闭
                        , style: 'bottom:0;'
                    });

                    setTimeout(function () {
                        window.location.href = window.location.href;
                    }, 2000);

                }else{
                    layer.open({
                        content: data.msg
                        , skin: 'msg'
                        , time: 2 //2秒后自动关闭
                        , style: 'bottom:0;'
                    });
                    $("#SubmitBtn").attr("disabled", false);
                }
            }
        });
    });

</script>
</body>
</html>
