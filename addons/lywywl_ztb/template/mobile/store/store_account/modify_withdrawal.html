<!doctype html>
<html>
{template 'store/common/header'}
<!--CSS-->
<link rel="stylesheet" href="{__PLUGIN__}/validform/5.3.2/Validform.css">
<link href="{MODULE_URL}resource/mobile/plugin/css/common.min.css?v=20170802" rel="stylesheet">

<body class="bgf2">
<!--中心区域-->
<section class="mt24">
    <form id="modify_withdrawal" method="post">
        <ul class="registerList">
            
            <li class="float">
                <section class="form_con clearfix">
                    <section class="input_item">
                        <input type="radio" value="0" name="model[withdrawal_type]" id="withdrawal_type0" class="withdrawal_type" {if $model['withdrawal_type']==0} checked {/if}>
                        <label for="withdrawal_type0"></label>
                        <span>支付宝</span>
                    </section>
                    <section class="input_item">
                        <input type="radio" value="1" name="model[withdrawal_type]" id="withdrawal_type1" class="withdrawal_type" {if $model['withdrawal_type']==1} checked {/if}>
                        <label for="withdrawal_type1"></label>
                        <span>银行卡</span>
                    </section>
                </section>
            </li>
            <li>
                <input class="regInput font32" type="text" placeholder="请输入新收款账号" name="model[withdrawal]" id="withdrawal"  nullmsg="请输入新收款账号" >
            </li>
            <li>
                <input class="regInput font32" type="password" placeholder="请输入商户安全密码" name="storepwd" id="storepwd" maxlength="6" datatype="*1-6" nullmsg="请输入商户安全密码！" errormsg="请输入6位商户安全密码！">
            </li>
        </ul>
        <section class="btn-de">
            <input name="token" value="{$_W['token']}" type="hidden" />
            <input type="hidden" name="submit" value="submit"/>
            <button type="submit" class="Button" id="SubmitBtn">确认提交</button>
        </section>
    </form>
</section>
<script src="{__PLUGIN__}/validform/5.3.2/Validform_v5.3.2_min.js"></script>
<script>
    $(function(){
        //为formContent 添加验证事件
        $("#modify_withdrawal").Validform({
            tiptype: function (msg, o, cssctl) {
                if (!o.obj.is("form")) {
                    if (o.type == 2) {
                        //loading带文字
                        layer.open({
                            type: 2
                            , content: '数据提交中'
                            , time: 999 //999秒后自动关闭
                        });
                    } else {
                        layer.closeAll();
                        layer.open({
                            content: msg
                            , skin: 'msg'
                            , time: 2 //2秒后自动关闭
                            , style: 'bottom:0;'
                        });
                    }
                }
            },
            ajaxPost: true,
            tipSweep: true,
            beforeSubmit: function (curform) {
                $("#SubmitBtn").attr("disabled", true);
            },
            callback: function (data) {
                layer.closeAll();
                if(data.status == 1){
                    layer.open({
                        content: data.msg
                        , skin: 'msg'
                        , time: 2 //2秒后自动关闭
                        , style: 'bottom:0;'
                    });

                    setTimeout(function () {
                        window.location.href = "{php echo $this->createMobileUrl('store.store_account');}";
                    }, 2000);

                }else{
                    layer.open({
                        content: data.msg
                        , skin: 'msg'
                        , time: 2 //2秒后自动关闭
                        , style: 'bottom:0;'
                    });
                    $("#SubmitBtn").attr("disabled", false);
                }
            }
        });
    });

</script>
</body>
</html>
