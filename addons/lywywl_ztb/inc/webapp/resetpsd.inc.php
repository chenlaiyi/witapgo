<?php
 goto jl5o7; g2ooz: if (!empty($model["\x6d\x6f\142\151\154\x65"])) { goto OQ0X7; } goto kjuW6; yJfTg: session_start(); goto pwEwx; Ay_mj: $templatecode = $config["\141\x6c\151\x5f\x74\155\160\x69\x64"]; goto OMzNM; Nc13u: $store = pdo_get("\154\171\167\x79\167\154\x5f\172\x74\x62\137\x73\164\x6f\x72\145\137\141\x63\x63\157\x75\156\164", array("\x64\x65\154\164\x69\x6d\x65" => 0, "\x75\x6e\x69\x61\x63\x69\144" => $uniacid, "\155\x6f\142\151\x6c\x65" => $model["\155\x6f\x62\151\154\x65"]), array("\151\x64", "\x70\141\163\x73\x77\x6f\x72\144", "\x73\141\154\164")); goto peNhn; bqa1X: exit; goto nq_CZ; OMzNM: $sms_content = "\351\200\x9a\xe8\277\207\xe9\x98\xbf\xe9\207\x8c\xe5\xa4\247\xe9\xb1\274\346\xa8\241\346\235\xbf\111\x44\357\274\x9a" . $templatecode . "\xef\274\214\347\255\xbe\xe5\220\x8d\xef\xbc\x9a" . $sign . "\xef\xbc\214\xe7\237\255\xe4\xbf\241\351\xaa\x8c\350\257\x81\xe7\xa0\x81\xef\274\x9a" . $sms_code . "\xef\xbc\214\xe5\x8f\x91\xe9\x80\x81\xe6\210\220\345\x8a\x9f\xef\274\x81"; goto SJwRL; FtYVq: $_SESSION["\165\x73\145\162\x5f\x72\x65\147\151\163\164\x65\x72\137\x63\157\144\x65\x5f\164\x69\x6d\145"] = TIMESTAMP; goto By0ax; xVWJ2: $_SESSION["\165\x73\145\162\137\162\145\147\151\x73\x74\145\162\137\x63\x6f\144\145"] = $mobile . "\54" . $sms_code; goto FtYVq; cXUy_: $title = "\345\277\230\350\xae\260\xe5\xaf\x86\347\xa0\x81"; goto jGTUf; DnR6m: $res = zucp_mt($sms_uid, $sms_key, $mobile, $sms_content, '', '', '') === true; goto yMTsW; t2TwW: $verifyCode = $_GPC["\166\145\x72\151\x66\x79\103\157\x64\x65"]; goto g2ooz; o37ps: jcfqK: goto Nc13u; FkW3j: goto WDzv8; goto VKkCS; JDfOL: $sms_content = "\346\202\xa8\xe7\x9a\204\351\252\x8c\xe8\257\201\347\240\201\xef\xbc\232" . $sms_code . "\54\350\257\xb7\xe4\272\216\x31\x30\xe5\210\206\xe9\x92\x9f\345\206\x85\350\xbe\x93\345\205\xa5\xe7\x9f\255\344\277\xa1\351\xaa\214\350\xaf\201\xe7\240\201\357\xbc\214\350\257\267\345\213\277\345\xb0\206\xe9\xaa\x8c\xe8\xaf\201\347\240\201\xe5\x91\x8a\347\x9f\245\xe4\273\x96\xe4\xba\xba\357\274\x81\xe3\200\220" . $config["\156\x61\x6d\145"] . "\xe3\200\x91"; goto fNopy; Huxyq: pdo_update("\154\x79\x77\x79\x77\x6c\x5f\x7a\x74\142\x5f\x73\164\157\162\x65\x5f\x61\143\x63\x6f\x75\x6e\x74", array("\160\141\163\x73\167\x6f\x72\x64" => $password, "\x75\160\144\141\164\145\164\151\155\x65" => TIMESTAMP), array("\x69\x64" => $store["\x69\144"])); goto SYXZx; l7m9d: exit(json_encode(array("\x73\x74\141\164\165\163" => 0, "\155\x73\x67" => "\xe5\xaf\xb9\344\xb8\x8d\350\xb5\267\357\xbc\214\351\xaa\214\xe8\257\201\xe7\237\255\xe4\277\241\xe5\217\221\xe9\200\201\xe5\244\xb1\xe8\264\245\xef\274\x81"), JSON_UNESCAPED_UNICODE)); goto TqTIJ; wPwL8: vJPNX: goto qGsc2; a6Dvt: if (intval($config["\163\x6d\163\137\x74\171\x70\145\x73"]) == 1) { goto kD0CJ; } goto JDfOL; XxuDu: if (!empty($store)) { goto PPR9B; } goto W7Rda; HvSTD: include $this->template("\162\145\163\x65\164\x70\163\x64\x2f\151\156\144\145\x78"); goto bqa1X; R0fZw: exit(json_encode(array("\x73\164\x61\x74\x75\163" => 0, "\x6d\x73\x67" => "\x54\157\x6b\145\156\xe9\x94\x99\350\257\257\357\xbc\201"), JSON_UNESCAPED_UNICODE)); goto FpGK5; r1QEc: $sign = $config["\141\x6c\x69\x5f\x73\x69\147\x6e"]; goto Ay_mj; By0ax: exit(json_encode(array("\163\164\x61\164\x75\163" => 1, "\x6d\163\x67" => "\xe7\237\xad\xe4\277\241\345\217\221\xe9\x80\201\346\210\x90\345\x8a\x9f\xef\274\x81"), JSON_UNESCAPED_UNICODE)); goto C9B7N; EKqh4: session_start(); goto WHtDq; WHtDq: $code_time = $_SESSION["\x75\x73\x65\162\x5f\x72\145\147\x69\163\x74\145\162\x5f\143\x6f\x64\145\x5f\164\x69\155\145"]; goto GMChN; ttJ2L: $store = pdo_get("\154\171\x77\171\167\154\137\x7a\164\x62\137\163\x74\x6f\162\x65\137\x61\143\x63\157\165\156\164", array("\144\x65\x6c\x74\x69\155\x65" => 0, "\x75\156\x69\x61\x63\151\x64" => $uniacid, "\155\x6f\142\x69\x6c\145" => $mobile), array("\x69\144")); goto XxuDu; iGN5Y: WDzv8: goto Qw24D; sRtbc: aMROl: goto HvSTD; boey6: wI5zF: goto cXUy_; qGsc2: $sms_code = random(6, true); goto a6Dvt; YSP0h: $ali_accesskeyid = $config["\x61\x6c\151\137\141\x63\x63\x65\163\x73\153\145\x79\151\x64"]; goto vuRBT; Se9SK: OQ0X7: goto W_Zs2; ZrQwW: exit(json_encode(array("\163\164\x61\164\x75\163" => 0, "\x6d\x73\147" => "\346\211\213\346\234\272\345\217\267\xe4\xb8\215\345\xad\x98\345\234\xa8\357\xbc\x81"), JSON_UNESCAPED_UNICODE)); goto ptRTg; nnm90: $allow_acts = array("\x69\156\x64\x65\170", "\162\145\x73\x65\164\x70\x73\144", "\x73\145\156\x64\123\155\x73\x43\x6f\x64\145"); goto Pk9e_; FpGK5: am2YG: goto fcUCK; PLmLc: if (checksubmit("\163\x75\x62\155\151\x74")) { goto am2YG; } goto R0fZw; goYNH: $sms_key = $config["\x73\x6d\163\x5f\x6b\145\x79"]; goto DnR6m; XmD4M: if (!($sms_count > $sms_limit)) { goto vJPNX; } goto TyTeR; Pk9e_: if (in_array($act, $allow_acts)) { goto wI5zF; } goto Dmt7n; YkXsP: hVh6v: goto czVkY; mQZVm: exit(json_encode(array("\163\164\141\x74\165\x73" => 0, "\x6d\x73\147" => "\xe6\x89\213\346\x9c\272\351\252\x8c\xe8\xaf\x81\347\xa0\x81\344\270\215\xe6\xad\243\xe7\241\256\xef\274\201"), JSON_UNESCAPED_UNICODE)); goto zIA6j; R_0T0: Hhsp3: goto cKVAJ; EzdW9: PPR9B: goto EKqh4; pwEwx: if (!($_SESSION["\x75\x73\x65\x72\x5f\x72\145\x67\151\x73\164\x65\x72\x5f\143\x6f\144\x65"] != $model["\155\157\x62\151\x6c\x65"] . "\x2c" . $verifyCode)) { goto xtpRa; } goto mQZVm; W7Rda: exit(json_encode(array("\163\x74\x61\164\x75\163" => 0, "\155\163\x67" => "\xe6\x89\x8b\346\234\272\xe5\x8f\xb7\xe4\270\215\xe5\255\x98\345\x9c\250\357\xbc\201"), JSON_UNESCAPED_UNICODE)); goto EzdW9; oAzie: exit(json_encode(array("\163\x74\141\164\165\x73" => 0, "\155\163\147" => "\xe5\257\xb9\344\xb8\x8d\xe8\xb5\xb7\xef\xbc\214\346\211\x8b\xe6\x9c\272\xe5\217\267\xe7\xa0\201\xe6\xa0\274\xe5\274\217\344\270\215\346\xad\243\347\xa1\256\xef\xbc\201"), JSON_UNESCAPED_UNICODE)); goto W5ctH; wDWD1: exit(json_encode(array("\163\x74\141\x74\x75\163" => 0, "\155\163\147" => "\xe5\257\271\344\270\215\350\265\267\54\xe8\xaf\xb7\xe8\276\223\345\x85\xa5\346\211\x8b\346\x9c\272\xe5\x8f\xb7\xef\xbc\x81"), JSON_UNESCAPED_UNICODE)); goto H97EH; bQoL9: andli: goto T1LiE; zIA6j: xtpRa: goto XybSs; fcUCK: $model = $_GPC["\155\x6f\x64\145\154"]; goto t2TwW; ZR2fd: YnuB0: goto yJfTg; SJwRL: $param = ["\x63\157\144\x65" => $sms_code]; goto xSbLR; LVbic: LmuyI: goto PLmLc; kjuW6: exit(json_encode(array("\x73\164\141\164\x75\x73" => 0, "\x6d\x73\147" => "\350\xaf\267\345\241\xab\345\206\x99\346\x89\x8b\346\x9c\xba\xe5\x8f\267\xe7\xa0\x81\xef\xbc\x81"), JSON_UNESCAPED_UNICODE)); goto Se9SK; DiLt1: if (!empty($model["\x70\141\163\x73\167\157\x72\144"])) { goto LO0Qj; } goto K3nXf; jAttf: LO0Qj: goto vJ7kV; qy_qT: $sms_count = pdo_fetchcolumn("\123\x45\x4c\x45\x43\x54\40\103\x4f\125\116\x54\x28\52\51\x20\106\x52\117\x4d\x20" . ztbTable("\163\x79\x73\x5f\163\155\x73") . "\x20\127\110\105\122\x45\40\x64\145\154\164\151\x6d\x65\40\x3d\x20\60\40\101\x4e\x44\40\163\x74\157\x72\x65\x5f\151\144\40\75\x20\55\61\x20\x41\x4e\104\x20\x6d\157\x62\151\x6c\145\40\75\x20\72\155\x6f\x62\x69\154\145\x20\x41\x4e\104\x20\106\122\117\115\x5f\125\116\x49\130\x54\x49\x4d\105\x28\143\x72\x65\141\x74\145\x74\x69\x6d\x65\54\40\47\x25\131\x25\x6d\x25\144\x27\x29\x20\75\x20\104\x41\x54\x45\x5f\106\117\x52\115\101\124\x28\x4e\x4f\x57\x28\x29\x2c\47\x25\x59\45\155\45\x64\x27\x29\40", array("\72\155\x6f\x62\151\x6c\145" => $mobile)); goto sY9Y8; W_Zs2: if (preg_match("\57\x5e\61\133\63\x34\65\x36\x37\70\71\135\134\144\x7b\71\175\44\x2f", $model["\155\x6f\142\151\x6c\x65"])) { goto jcfqK; } goto UNMho; VKkCS: Iz2kR: goto qy_qT; vJ7kV: if (!(strlen($model["\x70\141\163\x73\x77\x6f\x72\144"]) < 6 || strlen($model["\160\x61\x73\163\x77\x6f\x72\x64"]) > 16)) { goto XMfpC; } goto bMTSY; xSbLR: $result = dysms_send($ali_accesskeyid, $ali_accesskeysecret, $mobile, $sign, $templatecode, $param); goto CZ304; czVkY: goto xU22g; goto sRtbc; K3nXf: exit(json_encode(array("\x73\164\x61\x74\x75\x73" => 0, "\x6d\163\147" => "\350\257\xb7\xe5\241\253\345\x86\231\xe5\xaf\x86\xe7\xa0\201\xef\xbc\201"), JSON_UNESCAPED_UNICODE)); goto jAttf; Ar2tq: if (preg_match("\57\136\61\133\x33\x34\65\x36\67\70\71\135\x5c\x64\x7b\x39\x7d\44\x2f", $mobile)) { goto orlJs; } goto oAzie; cKVAJ: if ($res) { goto andli; } goto l7m9d; ptRTg: ppSi0: goto DiLt1; H97EH: H3Nu4: goto Ar2tq; d98Tp: XMfpC: goto Vn_RZ; bMTSY: exit(json_encode(array("\x73\164\141\164\165\x73" => 0, "\x6d\163\x67" => "\xe5\257\206\347\xa0\201\xe8\x8c\x83\345\x9b\xb4\345\x9c\xa8\66\176\x31\x36\344\275\x8d\344\271\x8b\xe9\x97\264\xef\274\x81"), JSON_UNESCAPED_UNICODE)); goto d98Tp; DdABQ: kD0CJ: goto YSP0h; TqTIJ: goto UfueC; goto bQoL9; Vn_RZ: if (!empty($verifyCode)) { goto YnuB0; } goto LJyAY; irVip: $act = trim($_GPC["\x61\143\x74"]); goto nnm90; C5D9s: if ($act == "\x69\x6e\144\145\x78") { goto aMROl; } goto IvyFm; XybSs: $password = store_hash($model["\x70\141\x73\x73\x77\x6f\x72\x64"], $store["\163\141\x6c\164"]); goto Huxyq; EkX2x: exit(json_encode(array("\x73\164\141\164\165\x73" => 0, "\x6d\163\147" => "\xe5\xb7\262\345\x8f\x91\351\200\x81\346\211\213\xe6\x9c\272\347\237\255\xe4\xbf\241\357\274\214" . 2 . "\xe5\x88\206\xe9\222\x9f\xe5\220\216\345\206\215\xe8\xaf\x95\xef\274\x81"), JSON_UNESCAPED_UNICODE)); goto FkW3j; fNopy: $sms_uid = $config["\x73\x6d\x73\x5f\x75\x69\x64"]; goto goYNH; A_etR: if (!empty($mobile)) { goto H3Nu4; } goto wDWD1; yMTsW: goto Hhsp3; goto DdABQ; peNhn: if (!empty($store)) { goto ppSi0; } goto ZrQwW; IvyFm: if ($act == "\162\x65\x73\x65\164\x70\x73\144" && $_W["\151\x73\160\157\163\164"]) { goto LmuyI; } goto H21jt; jl5o7: defined("\111\116\137\111\101") or exit("\x41\143\x63\145\x73\x73\x20\x44\145\156\x69\145\x64"); goto w5wwZ; C9B7N: UfueC: goto iGN5Y; jGTUf: $uniacid = $_W["\x75\x6e\151\141\x63\151\x64"]; goto C5D9s; Dmt7n: $act = "\151\x6e\144\x65\170"; goto boey6; K3gKU: global $_GPC, $_W, $config; goto irVip; LJyAY: exit(json_encode(array("\x73\164\141\164\165\x73" => 0, "\x6d\x73\x67" => "\350\xaf\267\345\xa1\253\xe5\206\231\xe6\211\213\xe6\x9c\xba\351\252\214\xe8\257\201\347\240\x81\xef\xbc\x81"), JSON_UNESCAPED_UNICODE)); goto ZR2fd; TyTeR: exit(json_encode(array("\163\164\141\164\165\x73" => 0, "\x6d\x73\x67" => "\350\257\245\346\x89\x8b\xe6\x9c\xba\345\x8f\267\xe7\xa0\x81\345\x8f\x91\xe9\x80\x81\xe9\x87\x8f\xe5\xb7\262\350\xbe\xbe\344\xb8\x8a\351\x99\220\357\274\201"), JSON_UNESCAPED_UNICODE)); goto wPwL8; sY9Y8: $sms_limit = intval($config["\x73\145\156\144\137\x73\155\x73\x5f\x6c\x69\x6d\151\164"]); goto XmD4M; W5ctH: orlJs: goto ttJ2L; fBdpz: $mobile = $_GPC["\x6d\x6f\142\x69\x6c\145"]; goto A_etR; CZ304: $res = $result->Message == "\117\113"; goto R_0T0; vuRBT: $ali_accesskeysecret = $config["\x61\154\x69\137\x61\143\143\145\x73\x73\153\145\x79\x73\145\x63\x72\145\164"]; goto r1QEc; SYXZx: exit(json_encode(array("\x73\164\x61\x74\165\163" => 1, "\x6d\x73\x67" => "\344\277\256\xe6\x94\xb9\346\x88\220\xe5\212\x9f\xef\xbc\x8c\346\255\xa3\345\x9c\250\344\270\xba\346\x82\xa8\xe8\xb7\xb3\xe8\275\xac\345\210\xb0\347\231\273\345\275\225\xef\xbc\x81", "\x75\x72\154" => $this->createWebAppUrl("\x6c\x6f\147\x69\156")), JSON_UNESCAPED_UNICODE)); goto YkXsP; w5wwZ: include MODULE_ROOT . "\x2f\151\156\143\57\143\x6f\155\155\x6f\156\56\x70\x68\160"; goto K3gKU; UNMho: exit(json_encode(array("\163\x74\x61\164\x75\x73" => 0, "\x6d\x73\x67" => "\xe6\x89\213\346\234\xba\xe5\217\267\xe7\xa0\x81\xe6\xa0\274\345\274\217\344\xb8\215\xe6\255\xa3\xe7\241\xae\xef\xbc\201"), JSON_UNESCAPED_UNICODE)); goto o37ps; H21jt: if (!($act == "\x73\145\x6e\x64\x53\155\x73\103\157\144\145")) { goto Zbf62; } goto fBdpz; kv1u_: goto hVh6v; goto LVbic; GMChN: if (empty($code_time) || time() - $code_time > 120) { goto Iz2kR; } goto EkX2x; Qw24D: Zbf62: goto kv1u_; T1LiE: pdo_insert("\154\x79\x77\x79\x77\154\x5f\172\x74\142\137\x73\x79\163\x5f\163\x6d\163", array("\x75\156\x69\x61\x63\x69\144" => $uniacid, "\163\x74\157\x72\x65\137\x69\144" => -1, "\x6d\x6f\x62\x69\x6c\x65" => $mobile, "\x72\x65\x61\163\157\x6e" => "\xe5\225\x86\345\256\266\346\x89\xbe\xe5\x9b\236\345\xaf\206\xe7\240\x81", "\156\157\x74\145" => $sms_content, "\143\x72\145\x61\164\145\164\x69\155\145" => TIMESTAMP)); goto xVWJ2; nq_CZ: xU22g:
