<?php
 class FileLock { private $path = ''; private $fp = ''; private $lockFile = ''; public function __construct($name, $path = '') { goto G3M1g; P7_k3: goto D9cT2; goto IdL_x; G3M1g: if (empty($path)) { goto Vu0Fh; } goto c96j5; IdL_x: Vu0Fh: goto bJlkj; mzPfp: $this->lockFile = $this->path . md5($name) . "\x2e\x6c\157\143\x6b"; goto wljxM; Qfqf7: D9cT2: goto mzPfp; bJlkj: $this->path = dirname(__FILE__) . "\57"; goto Qfqf7; c96j5: $this->path = $path; goto P7_k3; wljxM: } public function lock($block = true) { goto vjntn; xD7WV: return flock($this->fp, LOCK_EX, $block); goto Z3dYO; iBUyT: if (!($this->fp === false)) { goto Cqm97; } goto dcxI2; MHult: return flock($this->fp, LOCK_EX | LOCK_NB, $block); goto fHi_4; jVWMU: Cqm97: goto t0Wml; Z3dYO: A1xpZ: goto MHult; vjntn: $this->fp = fopen($this->lockFile, "\x61\53"); goto iBUyT; dcxI2: return false; goto jVWMU; t0Wml: if (!$block) { goto A1xpZ; } goto xD7WV; fHi_4: } public function unlock() { goto ZmjnL; ik4jI: @unlink($this->lockFile); goto yKizX; wipcp: @flock($this->fp, LOCK_UN); goto Y2SuR; Y2SuR: clearstatcache(); goto T_YqZ; ZmjnL: if (!($this->fp !== false)) { goto t9g5z; } goto wipcp; T_YqZ: t9g5z: goto rKc3h; rKc3h: @fclose($this->fp); goto ik4jI; yKizX: } }
