<?php
 class UploadFile { private $max_size = "\x32\x30\x34\70\60\60\x30"; private $rand_name = true; private $allow_type = array(); private $error = 0; private $msg = ''; private $new_name = ''; private $save_path = ''; private $uploaded = ''; private $file = ''; private $file_type = array(); private $file_ext = ''; private $file_name = ''; private $file_size = 0; private $file_tmp_name = ''; public function __construct($rand_name = true, $save_path = "\56\x2f\165\x70\x6c\x6f\x61\144\57", $allow_type = '', $max_size = "\62\x30\64\70\60\60\60") { goto QWTZP; SHwX9: $this->save_path = $save_path; goto u5WxI; QWTZP: $this->rand_name = $rand_name; goto SHwX9; u5WxI: $this->allow_type = $this->get_allow_type($allow_type); goto IMMgf; IMMgf: $this->max_size = $max_size; goto FfzPO; FfzPO: } public function upload_file($file) { goto bLjMt; rzmFb: Mw6km: goto yxyup; wG_iN: switch ($this->error) { case 0: $this->msg = ''; goto E6wyG; case 1: $this->msg = "\xe4\xb8\x8a\xe4\xbc\240\xe6\226\x87\344\xbb\xb6\xe8\xb6\x85\345\x87\xba\xe4\272\206\160\150\160\x2e\151\x6e\x69\xe4\xb8\255\xe6\226\207\344\273\266\xe5\244\247\xe5\xb0\217\xe9\x99\220\xe5\210\266\357\xbc\201"; goto E6wyG; case 2: $this->msg = "\344\xb8\x8a\xe4\274\240\346\226\x87\xe4\273\xb6\350\xb6\205\345\207\272\344\xba\x86\x4d\x41\130\137\x46\111\114\105\137\x53\111\x5a\x45\xe7\x9a\x84\xe6\x96\x87\xe4\xbb\266\345\xa4\247\xe5\xb0\x8f\357\xbc\201"; goto E6wyG; case 3: $this->msg = "\xe4\270\x8a\344\xbc\xa0\346\x96\207\xe4\xbb\266\350\242\253\xe9\x83\xa8\xe5\210\206\344\270\212\344\xbc\xa0\xef\274\201"; goto E6wyG; case 4: $this->msg = "\xe8\xaf\267\351\200\211\346\213\xa9\xe9\x9c\200\xe8\246\x81\344\270\x8a\344\274\xa0\xe7\232\204\346\226\x87\xe4\xbb\xb6\357\274\201"; goto E6wyG; case 5: $this->msg = "\xe4\270\212\344\274\240\xe6\226\x87\344\273\266\345\xa4\247\xe5\260\217\344\xb8\272\60\x4b\x42\357\274\214\xe8\xaf\267\xe9\207\215\346\226\xb0\351\x80\211\xe6\x8b\xa9\357\274\x81"; goto E6wyG; default: $this->msg = "\345\257\271\xe4\xb8\x8d\xe8\xb5\267\357\xbc\214\xe6\x96\207\xe4\xbb\xb6\344\xb8\212\xe4\274\xa0\xe5\244\xb1\xe8\264\xa5\357\274\201"; goto E6wyG; } goto PG59q; rFPHI: return false; goto pKg9C; Bw5Lv: E6wyG: goto vSu4v; DZjcQ: $this->ext = $this->get_file_type($this->file_name); goto wG_iN; s4O3_: if (move_uploaded_file($this->file_tmp_name, $this->uploaded)) { goto ajOqG; } goto BW1LE; PWEIM: BzDLp: goto UrBWa; aMAZx: return false; goto nMJ1j; NLCja: $this->error = 0; goto gVdEY; e4PLL: if (file_exists($dirpath)) { goto BzDLp; } goto QZ9wW; uDV3h: $this->msg = "\344\xb8\x8a\344\xbc\240\xe6\226\x87\xe4\xbb\xb6\xe5\xa4\xa7\345\260\217\xe6\x93\x8d\344\xbd\x9c\351\231\220\xe5\x88\266\357\xbc\x8c\350\257\267\351\207\215\346\x96\260\351\x80\x89\xe6\x8b\251\357\xbc\x81"; goto WXGRH; QZ9wW: mkdir($dirpath); goto PWEIM; BW1LE: $this->msg = "\xe5\257\271\xe4\xb8\215\350\265\267\xef\274\214\346\226\207\344\xbb\266\344\270\212\344\274\xa0\xe5\xa4\xb1\xe8\264\245\xef\xbc\x81"; goto HiEXm; XxyJ3: $dirpath = ''; goto IgPQU; HiEXm: $this->error = 8; goto rFPHI; IgPQU: $i = 0; goto GuXlJ; XXc1S: $dirpath .= $array_dir[$i] . "\x2f"; goto e4PLL; KUM8A: return false; goto GQFMn; UDKIo: $this->error = $file["\x65\162\x72\x6f\x72"]; goto Zhtj1; yxyup: qczOQ: goto ihgBm; vSu4v: if (!($this->error == 0 && is_uploaded_file($this->file_tmp_name))) { goto qczOQ; } goto qvqze; JlBVi: $this->msg = "\xe5\257\271\344\270\215\350\xb5\xb7\xef\274\x8c\xe4\270\x8a\344\274\240\xe6\x96\x87\xe4\xbb\266\xe7\261\xbb\xe5\x9e\213\344\270\x8d\xe6\xad\xa3\xe7\xa1\xae\xef\xbc\x81"; goto xFgSw; PG59q: Ch_hM: goto Bw5Lv; bLjMt: $this->file_name = $file["\x6e\x61\x6d\145"]; goto eOD9c; WTNv0: $this->uploaded = $this->save_path . $this->new_name; goto s4O3_; fwdWB: goto ZeMY4; goto rzmFb; gVdEY: return true; goto NYAyQ; xFgSw: $this->error = 6; goto KUM8A; nMJ1j: nqKoq: goto LVmL7; K_2Kn: if (!($i < count($array_dir))) { goto Mw6km; } goto XXc1S; bDotI: $this->msg = "\xe6\x81\255\345\x96\x9c\346\x82\250\xef\xbc\214\346\x96\x87\344\273\266\344\xb8\x8a\xe4\xbc\240\346\210\220\345\x8a\x9f\357\274\x81"; goto NLCja; LVmL7: $array_dir = explode("\57", $this->save_path); goto XxyJ3; qCody: $i++; goto fwdWB; pKg9C: goto VirEQ; goto ohhc9; GBdMY: if (!($this->file_size > $this->max_size)) { goto nqKoq; } goto uDV3h; ohhc9: ajOqG: goto bDotI; eOD9c: $this->file_size = $file["\163\151\x7a\x65"]; goto UDKIo; Zhtj1: $this->file_tmp_name = $file["\164\x6d\160\x5f\x6e\x61\x6d\145"]; goto DZjcQ; qvqze: if (!(in_array($this->ext, $this->allow_type) == false)) { goto i38sf; } goto JlBVi; NYAyQ: VirEQ: goto R03O_; UrBWa: Z0XCN: goto qCody; GQFMn: i38sf: goto GBdMY; WXGRH: $this->error = 7; goto aMAZx; GuXlJ: ZeMY4: goto K_2Kn; ihgBm: $this->set_file_name(); goto WTNv0; R03O_: } public function set_file_name() { goto lxxiV; b4K2b: VCt3r: goto vyWS6; pw6bH: $a = explode("\40", microtime()); goto hhLGr; y3doS: goto VCt3r; goto Jd2UI; lxxiV: if ($this->rand_name == true) { goto zf_83; } goto tXb8f; Jd2UI: zf_83: goto pw6bH; TyX8Z: $this->new_name = $t . "\x2e" . $this->ext; goto b4K2b; hhLGr: $t = $a[1] . $a[0] * 1000000; goto TyX8Z; tXb8f: $this->new_name = $this->file_name; goto y3doS; vyWS6: } public function get_file_type($filename) { $ext = pathinfo($filename, PATHINFO_EXTENSION); return $ext; } public function get_allow_type($allow_type) { goto VjQuy; AQEPZ: HmkiZ: goto ZOKv0; VjQuy: $s = array(); goto ys1UO; lNjnu: iEqn5: goto apvR5; ys1UO: if (is_array($allow_type)) { goto iEqn5; } goto CGfGO; NaASi: goto HmkiZ; goto lNjnu; ZOKv0: return $s; goto ul_Hh; apvR5: foreach ($allow_type as $value) { $s[] = $value; W2nkI: } goto J19l1; J19l1: t_4BB: goto AQEPZ; CGfGO: $s = preg_split("\57\x5b\x5c\x73\54\174\73\135\53\x2f", $allow_type); goto NaASi; ul_Hh: } public function get_msg() { return array("\155\163\x67" => $this->msg, "\x65\162\162\157\162" => $this->error, "\146\151\x6c\x65\x70\x61\x74\x68" => $this->uploaded, "\145\x78\x74" => $this->ext); } }
