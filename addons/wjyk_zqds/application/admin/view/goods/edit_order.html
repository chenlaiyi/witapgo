<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>服务项目</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="__PUBLIC__/static/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="__PUBLIC__/static/layuiadmin/style/admin.css" media="all">
  		<style>
			form{
            padding-right:15px ;
        }
		.color-red{
			color: red;
        }
      .order-container {
            display: flex;
            position: relative;
            overflow: hidden;
            border: 1px solid #efefef;
            margin: 0px;
            background-color: #FFFFFF;
        	padding: 30px;
    	}
      
      .col-sm {
            float: left;
            padding-right: 10px;
            padding-left: 10px;
            position: relative;
            width: 80px;
        }
		
		li {
		    list-style: none;
		    padding: 5px;
		}
		
		.order-title {
		    line-height: 62px;
		    font-size: 16px;
		    color: #000;
		    font-weight: bold;
			padding-left: 40px;
		}
		
		.table {
		    table-layout: fixed;
		    position: relative;
		    color: #666;
			width: 50%;
			max-width: 50%;
			margin-bottom: 20px;
		}
		table {
		    background-color: transparent;
			border-color: grey;
			border-spacing: 0;
			border-collapse: collapse;
		}
	
		.table .trorder, .table .trfooter {
		    border: 1px solid #efefef;
		}
		.table tr {
		    height: 24px;
		}
		
		tr {
		    display: table-row;
		    vertical-align: inherit;
		}
		
		.table .trorder, .table .trfooter {
		    border: 1px solid #efefef;
		}
		
		.table .trorder td {
		    border-right: 1px solid #efefef;
		}
		
		.order-container .status {
		    height: 70px;
		    line-height: 22px;
		}
		
		.font18 {
		    font-size: 20px;
		    font-weight: bold;
		}
     
    </style>
	</head>
	<body>
		<form class="layui-form layui-form-pane" style="margin-top:21px;">

			<div style="background-color: #FFFFFF;">
				<div class="order-title">订单详情</div>

				<div>
					<div class="row order-container">
						<div style="border: #EFEFEF solid 1px;width: 100%;display: flex;display: flex;justify-content: space-around;align-items: center;">
							<div class="order-container-left" style="width: 50%;padding: 30px;">
								<div class="row">
									<div class="col-md-12">
										<ul>
							
											<li class="text">
												<span class="col-sm">买家：</span>
												<span class="text-default">
													{$srdb['nickname']}
												</span>
											</li>
											
											{if $srdb['goods_type'] != 2}
											<li class="text">
												<span class="col-sm">收货人：</span>
												<span class="text-default">
													{$srdb['location']}{$srdb['detail']}, {$srdb['consignee']}, {$srdb['consignee_phone']}
												</span>
											</li>
											{/if}
											<li class="text"><span class="col-sm">订单编号：</span><span class="text-default">{$srdb['logno']}</span></li>
											
											{if ($srdb['is_status'] == 3 && $srdb['goods_type'] != 2) ||  ($srdb['is_status'] == 4 && $srdb['goods_type'] != 2) }
											<li class="text">
												<span class="col-sm">快递编号：</span>
												<i><span class="color-red" style="font-weight: bold;">{$srdb['express_no']}</span></i>
											</li>
											<li class="text">
												<span class="col-sm">快递公司：</span>
												<i><span class="color-red" style="font-weight: bold;">{$srdb['express_name']}</span></i>
											</li>
											{/if}
											
											{if $srdb['goods_type'] == 2 && $srdb['is_status'] == 4 && !empty($srdb['serial'])}
											
											<li class="text">
												<span class="col-sm">{$srdb['goods_virtual_type']}：</span>
												<i><span class="color-red" style="font-weight: bold;">{$srdb['serial']}</span></i>
											</li>
											
											{/if}
											
											
										</ul>
									</div>
							
								</div>
							</div>
							
							<div style="width: 1px;height: 100%;background-color: #EFEFEF;"></div>
							
							<div style="width: 50%;padding: 30px;">
								<div class="status">
									
									<span class="text"> 订单状态：</span>
									
									{if $srdb['is_status'] == 1}
										<span class="text-default font18">待付款</span>
									{elseif $srdb['is_status'] == 2}
										<span class="text-default font18">待发货</span>
										<button  type="button" class="layui-btn layui-btn-normal layui-btn-sm" id="ship" name="ship">确认发货</button>
									{elseif $srdb['is_status'] == 3}
										<span class="text-default font18">已发货</span>
										<button  type="button" class="layui-btn layui-btn-normal layui-btn-sm" id="ship" name="ship">修改快递</button>
									{elseif $srdb['is_status'] == 4}
										<span class="text-default font18">已完成</span>
									{/if}
								</div>
								
								{if !empty($srdb['remark'])}
								<div class="status">
									<span>备注信息：</span>
									<span>{$srdb['remark']}</span>
								</div>
								{/if}
							</div>
						</div>
					</div>

					<h3 class="order-title">商品信息</h3>

					<div style="display: flex;justify-content: flex-start;align-items: center;margin-left: 40px;margin-bottom:30px;">
						<table class="table">
							<thead>
								<tr class="trorder" style="background: #fff">
									<th class="" style="width: 80px;text-align: right;padding: 10px 0px;">
										商品标题
									</th>
									<th style="width: 31%;">

									</th>
									<th style="text-align: center;width: 30%;padding: 10px 0px;">单价</th>
									<th style="text-align: center;width: 30%;padding: 10px 0px;border-right: #EFEFEF solid 1px;">数量</th>
								</tr>
							</thead>
							<tbody>

								<tr class="trorder" style="background: #fff">
									<td style="text-align: right;padding-right: 0;border-right: none;">
										<img src="{$srdb['goods_pic']}" style="width:52px;height:52px;padding:1px;"
										 onerror="">
									</td>
									<td style="min-width: 300px;border-left: none;">
										<span style="display: block;line-height: 22px;max-width: 250px;white-space: nowrap;
						        overflow: hidden;text-overflow: ellipsis;margin-left: 5px;">{$srdb['goods_name']}</span>
									</td>

									<td style="text-align: center">
										
										<p>{$srdb['goods_price']}元</p>
									</td>
									<td style="text-align: center">
										<p>{$srdb['count']}</p>
									</td>

								</tr>
							</tbody>

							<tfoot style="padding-top: 20px">
								<tr class="trorder" style="height: 24px;">
									<td colspan="2" style="padding-left: 20px"> </td>

									<td colspan="6" style="padding-right: 60px;text-align: right;">
										<div class="price" style="padding: 20px;">
										

											<p> <span class="price-inner">商品小计：</span><span style="font-weight: bold">{$srdb['goods_price']*$srdb['count']}元</span></p>
											
											{if $srdb['deduction'] > 0}
											<p><span class="price-inner">抵扣金额：</span><span style="font-size: 14px;font-weight: bold;color: #e4393c">{$srdb['deduction']}元</span></p>
											{/if}
											
											<p><span class="price-inner">实付款：</span><span style="font-size: 14px;font-weight: bold;color: #e4393c">{$srdb['integral']}{$name}
											
											{if $srdb['total'] > 0}
											+{$srdb['total']}元
											{/if}
											</span></p>

										
											

											
										</div>
									</td>
								</tr>
							</tfoot>

						</table>
					</div>


				</div>

			</div>
  
  
  <div class="layui-form-item">
    <div class="layui-input-block">
    	
    	<input type="button" class="layui-btn layui-btn-primary" onclick="history.go(-1)" value="返回列表"> 
      
    </div>
  </div>
  <!-- 更多表单结构排版请移步文档左侧【页面元素-表单】一项阅览 -->
</form>
<!-- 表单弹框 -->
<script  type="text/html" id="form">
<form class="layui-form" style="margin-top:21px;">
  <input type="hidden" name="id" id="id">

  <div class="layui-form-item">
    <label class="layui-form-label">快递编号</label>
    <div class="layui-input-block" style="width:80%">
      <input type="text" name="express_no" id = "express_no" required lay-verify="required" placeholder="请输入快递编号" autocomplete="off" class="layui-input" >
    </div>
  </div>

<div class="layui-form-item">
    <label class="layui-form-label">快递公司</label>
    <div class="layui-input-block" style="width:80%">
      <input type="text" name="express_name" id = "express_name" required lay-verify="required" placeholder="请输入快递公司" autocomplete="off" class="layui-input" >
    </div>
  </div>
  
  <div class="layui-form-item">
    <div class="layui-input-block">
      <button class="layui-btn" lay-submit lay-filter="demo1">立即提交</button>
    </div>
  </div>
</form>
</script>
<div class="layui-footer" style="position:absolute;bottom:0;text-align:center;width:100%">
	{include file='../addons/wjyk_zqds/application/admin/view/index/footer.html' /}
</div>
<script src="__PUBLIC__/static/layuiadmin/layui/layui.js"></script>
<script type="text/javascript" src="__PUBLIC__/static/ueditor/ueditor.config.js"></script>
<script type="text/javascript" src="__PUBLIC__/static/ueditor/ueditor.all.js"></script>

<script>

	layui.config({
	    base: '__PUBLIC__/static/layuiadmin/' //静态资源所在路径
	}).extend({
	    index: 'lib/index' //主入口模块
	}).use(['jquery','layer', 'index', 'table','upload','layedit'], function(){
		var $ = layui.$
		, layer = layui.layer
		, layedit = layui.layedit
	    , table = layui.table
	    , form = layui.form
	    , upload = layui.upload;
		
		$('.upload_img').on('click',function () {
			var url = $(this).attr('id');
			$(this).parents('.image-container').remove();
		});
		

        $('#ship').on('click', function(){
			  layer.open({
                title : '<i class="fa fa-plus"></i>&nbsp;商城订单发货',
                type : 1,
                fix : false,
                skin : 'layui-layer-rim',
                // 加上边框
                area : [ '60%', '30%' ],
                // 宽高
                content : $('#form').html(),
                success: function (layero, index) {
                    $('#id').val("{$srdb['id']}");
                    $('#express_no').val("{$srdb['express_no']}");
                    $('#express_name').val("{$srdb['express_name']}");
                }
            });
	        });
        
        form.on('submit(demo1)', function(data){
            var admin = layui.admin

            $.ajax({
                url:"{:siteUrl('admin/goodsOrder/deliver_order','','web')}",
                data:data.field,
                type:"POST",
                success: function(res){
                	
                	if(res.code == 1 ){
                		layer.msg(res.msg,{icon: 1,time:2000},function(){
                			window.location.href="{:siteUrl('admin/goodsOrder/index','','web')}";
                		});
                	}else{
                		layer.msg(res.msg,{icon: 2,time:3000},function(){
                			window.location.href="{:siteUrl('admin/goodsOrder/index','','web')}";
                		});
                	}
                }
            })
            return false
  
        });
		  
        
        

        //表单取值
        layui.$('#LAY-component-form-getval').on('click', function(){
            var data = form.val('example');
            alert(JSON.stringify(data));
        });

    });
</script>
</body>
</html>