<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>系统设置</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="__PUBLIC__/static/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="__PUBLIC__/static/layuiadmin/style/admin.css" media="all">
    <style>
		.layui-form-label{
			width:145px;
        }
		.layui-input-block{
			margin-left:175px;
		}
        form{
            padding-right:15px ;
        }
    </style>
</head>
<body>
<form class="layui-form" style="margin-top:21px;">   <div class="layui-form-item">    <label class="layui-form-label">热门背景图</label>    <button type="button" class="layui-btn" id="test2">多图片上传</button>     <div class="layui-form-mid layui-word-aux">建议上传677px * 688px尺寸，或者等比例图片</div>	  <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">	    预览图：	    <div class="layui-upload-list"  id="ImgPreview" style="display: flex;">          	{if !empty($set['popular_pic'])}         		{foreach  $set['popular_pic'] as $v}	  			<div class="image-container" id="container{$v}">			        <div class="delete-css">	            		<div id="{$v}" class="upload_img layui-btn layui-btn-danger layui-btn-xs">删除</div>	            	</div>	                <img id="showImg" style="width: 150px; margin:10px;cursor:pointer;" src="{$v}"  >	                <input value="{$v}" name="popular_pic[]" class="popular_pic" type="hidden">	            </div>		        {/foreach}			{/if}        </div>	 </blockquote>  </div>    
  <div class="layui-form-item">
    <div class="layui-input-block">
      <button class="layui-btn" lay-submit lay-filter="demo1">立即提交</button>
    </div>
  </div>
  <!-- 更多表单结构排版请移步文档左侧【页面元素-表单】一项阅览 -->
</form>
<div class="layui-footer" style="margin-top:20px;display: flex;justify-content: center;align-items: flex-end;">
	{include file='../addons/wjyk_zqds/application/admin/view/index/footer.html' /}
</div>
<script src="__PUBLIC__/static/layuiadmin/layui/layui.js"></script>
<script>
	layui.config({
	    base: '__PUBLIC__/static/layuiadmin/' //静态资源所在路径
	}).extend({
	    index: 'lib/index' //主入口模块
	}).use(['jquery','layer', 'index', 'table','upload'], function(){
		var $ = layui.$
		, layer = layui.layer
	    , table = layui.table
	    , form = layui.form
	    , upload = layui.upload;
		$('.upload_img').on('click',function () {			var url = $(this).attr('id');			$(this).parents('.image-container').remove();		});    	    	$(document).on("click", ".image-container .delete-css .layui-btn", function(event){    	    $(this).parent().parent().remove();    	})    	    	upload.render({           elem: '#test2'          	,url: "{:siteUrl('admin/index/upload','','web')}"         	,multiple: true        	, before: function (obj) {                layer.msg('图片上传中...', {                  icon: 16,                  shade: 0.01,                  time: 3000                })              }         ,done: function(res){         	 $('#ImgPreview').append('<div class="image-container"><div class="delete-css"><button class="layui-btn layui-btn-danger layui-btn-xs">删除</button></div>\n' +                '<img  style="width: 150px; margin:10px;cursor:pointer;" src="'+  res.msg +'"><input value="'+ res.msg +'" name="popular_pic[]" class="popular_pic"  type="hidden">');           }         });

        form.on('submit(demo1)', function(data){
            var admin = layui.admin
            admin.req({
                url:"{:siteUrl('admin/system/set_home','','web')}",
                data:data.field,
                type:"POST",
                done:res=>{
                    if(res.code == 0 ){
                		layer.msg("设置成功");
                	}
                }
            })
            return false
        });

    });
</script>
</body>
</html>