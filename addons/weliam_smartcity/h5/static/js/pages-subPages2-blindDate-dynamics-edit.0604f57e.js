(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-subPages2-blindDate-dynamics-edit"],{2240:function(t,e,i){"use strict";var a=i("4ea4");i("99af"),i("4160"),i("a434"),i("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(i("2c7c")),n=a(i("ec93")),d=a(i("8f6e")),r={data:function(){return{form:{content:"",photo:[],photo_show:[],video:"",lng:"",lat:"",address:"点击定位地址"},dynamic_id:"",isOpenLaction:!1,disabled:!0,userAddress:{},owenscitylist:[],phoneHight:"",phoneWidth:"",latlngs:null,counts:!0}},components:{PopManager:d.default},onLoad:function(t){var e=this;0!=t.id&&(console.log("触发"),e.dynamic_id=t.id),e.owenscitylist=uni.getStorageSync("cityList");var i=uni.getStorageSync("curLoction")||{};e.form.lat=i.latitude||"",e.form.lng=i.longitude||"",0!=t.id&&e.getMemberList(),e.latlngs=uni.getStorageSync("curLoction"),e.toLocale(),uni.getSystemInfo({success:function(t){e.phoneHight=t.windowHeight+"px",e.phoneWidth=t.windowWidth+"px"}})},methods:{getMemberList:function(){var t=this;o.default._post_form("&p=dating&do=dynamicEdit&type=get",{id:t.dynamic_id},(function(e){0==e.errno&&(t.form=e.data,t.form.address=e.data.address?e.data.address:"点击定位地址",t.form.photo_show=e.data.photo_show?e.data.photo_show:[])}),!1,(function(){}))},handlesubmitClick:function(){var t=this,e={};"点击定位地址"===t.form.address&&(t.form.address="",t.form.lat="",t.form.lng=""),e.data=JSON.stringify(t.form),o.default._post_form("&p=dating&do=dynamicEdit&id=".concat(t.dynamic_id,"&type=post"),e,(function(t){0==t.errno&&uni.reLaunch({url:"/pages/subPages2/blindDate/dynamics/myself"})}),!1,(function(){}))},goLocation:function(){var t=this;t.isOpenLaction=!0},getloctions:function(t){console.log(t,"666666");var e=this;o.default._post_form("&p=member&do=lng2areaid&lng=".concat(t.lng,"&lat=").concat(t.lat),{},(function(i){e.userAddress.detailed_address=t.detailed_address,e.userAddress.lat=t.lat,e.userAddress.lng=t.lng,e.userAddress.provinceid=i.data.provinceid,e.userAddress.countyid=i.data.countyid,e.userAddress.cityid=i.data.cityid,e.userAddress.provinceidName="",e.owenscitylist.forEach((function(t,i){t.id==e.userAddress.provinceid&&(e.form.address=t.name,e.userAddress.provinceidName=t.name,t.area.forEach((function(t){t.id==e.userAddress.cityid&&(e.form.address="".concat(e.form.address).concat(t.name),e.userAddress.areaidName=t.name,console.log(e.form.address,t.name),t.dist.forEach((function(t){t.id==e.userAddress.countyid&&(e.form.address="".concat(e.form.address).concat(t.name),e.userAddress.distidName=t.name)})))})))})),console.log(e.userAddress)}))},toLocale:function(){var t,e=this,i=1;window.addEventListener("message",(function(a){var o=a.data;e.counts&&((i>1||e.counts)&&o&&"locationPicker"==o.module&&(console.log(i),t={lat:o.latlng.lat,lng:o.latlng.lng,detailed_address:o.poiaddress},e.isOpenLaction=!1,e.disabled=!1,e.getloctions(t)),i++,e.counts=!1,setTimeout((function(){e.counts=!0}),1e3))}),!1)},uoloadIgs:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=this;n.default.uoloadIg(i.localIds[e],(function(n){if("uploadImage:ok"===n.errMsg){uni.showLoading({});var d={upload_type:2,id:n.serverId};o.default._post_form("&do=uploadFiles",d,(function(o){0===o.errno&&(a.form.photo.push(o.data.image),a.form.photo_show.push(o.data.img),e<t-1&&(e++,uni.setTimeout(a.uoloadIgs(t,e,i),500)),a.$forceUpdate())}),!1,(function(){uni.hideLoading()}))}else uni.hideLoading(),o.default.showError("上传失败")}))},upImages:function(){var t=this,e=6-t.form.photo_show.length||0;e<=0?o.default.showError("最多上传6涨图片"):n.default.choseImage((function(e){var i=e.localIds.length;t.uoloadIgs(i,0,e)}),e)},deleteImage:function(t){this.form.photo_show.splice(t,1),this.form.photo.splice(t,1)},upLoadVideo:function(){var t=this;uni.chooseVideo({count:1,sourceType:["camera","album"],success:function(e){uni.showLoading(),uni.uploadFile({url:o.default.api_root+"&do=uploadFiles",filePath:e.tempFilePath,name:"file",formData:{upload_type:1,is_base:1},success:function(e){var i=JSON.parse(e.data),a=new t.$util.Base64;console.log("data",i),0===i.errno?t.form.video=a.decode(i.data.img):o.default.showError(i.message,(function(){})),uni.hideLoading()},fail:function(t){uni.hideLoading()}})}})},deleteVideo:function(){this.form.video="",this.isShowVideoClose=!1}}};e.default=r},"2ec1":function(t,e,i){"use strict";i.r(e);var a=i("2240"),o=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,(function(){return a[t]}))}(n);e["default"]=o.a},"4feb":function(t,e,i){"use strict";i.r(e);var a=i("d3f1"),o=i("2ec1");for(var n in o)"default"!==n&&function(t){i.d(e,t,(function(){return o[t]}))}(n);i("9206");var d,r=i("f0c5"),s=Object(r["a"])(o["default"],a["b"],a["c"],!1,null,"213b6089",null,!1,a["a"],d);e["default"]=s.exports},"79db":function(t,e,i){var a=i("a41a");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=i("4f06").default;o("7839c8cf",a,!0,{sourceMap:!1,shadowMode:!1})},9206:function(t,e,i){"use strict";var a=i("79db"),o=i.n(a);o.a},a41a:function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.desc[data-v-213b6089]{width:%?690?%;height:%?260?%;margin:auto;padding-top:%?30?%;color:#333;font-size:%?28?%}.desc .label[data-v-213b6089]{height:%?40?%}.desc .value[data-v-213b6089]{width:100%;height:%?200?%;margin-top:%?20?%;line-height:%?40?%}.line[data-v-213b6089]{width:%?690?%;height:%?8?%;background-color:#f8f8f8;margin:auto;-webkit-border-radius:%?4?%;border-radius:%?4?%}.avatar-info[data-v-213b6089]{width:%?690?%;height:auto;margin:auto;padding:%?40?% 0}.avatar-info .up-box[data-v-213b6089]{width:100%;height:auto;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap}.avatar-info .up-box .up-load[data-v-213b6089]{width:%?158?%;height:%?158?%;line-height:%?158?%;text-align:center;-webkit-border-radius:%?20?%;border-radius:%?20?%;margin:%?30?% %?10?% 0 0;border:%?1?% dashed #ccc;position:relative}.avatar-info .up-box .up-load .iconfont[data-v-213b6089]{font-size:%?60?%;color:#333;font-weight:700}.avatar-info .up-box .up-load uni-image[data-v-213b6089]{width:%?158?%;height:%?158?%;-webkit-border-radius:%?20?%;border-radius:%?20?%}.avatar-info .up-box .up-load .close[data-v-213b6089]{width:%?30?%;height:%?30?%;-webkit-border-radius:%?15?%;border-radius:%?15?%;color:#fff;background-color:rgba(0,0,0,.5);position:absolute;top:%?10?%;right:%?10?%;-webkit-transform:rotate(45deg);transform:rotate(45deg);font-size:%?32?%;line-height:%?28?%;text-align:center}.avatar-info .avatar[data-v-213b6089]{border:none}.avatar-info .qrcode[data-v-213b6089]{border:none}.h1-title[data-v-213b6089]{height:%?45?%;line-height:%?45?%;font-size:%?32?%;color:#333;font-weight:700}.video-box[data-v-213b6089]{width:%?690?%;margin:%?30?% auto 0;height:auto}.video-box .video-up-load[data-v-213b6089]{width:100%;height:%?390?%;-webkit-border-radius:%?20?%;border-radius:%?20?%;border:%?1?% dashed #ccc;line-height:%?390?%;text-align:center;margin:%?30?% auto %?40?%;position:relative}.video-box .video-up-load .iconfont[data-v-213b6089]{font-size:%?54?%;font-weight:700}.video-box .video-up-load .video[data-v-213b6089]{width:100%;height:100%}.video-box .video-up-load .close[data-v-213b6089]{width:%?60?%;height:%?60?%;-webkit-border-radius:%?30?%;border-radius:%?30?%;color:#fff;background-color:rgba(0,0,0,.5);position:absolute;top:%?18?%;right:%?18?%;-webkit-transform:rotate(45deg);transform:rotate(45deg);font-size:%?50?%;line-height:%?60?%;text-align:center}.footer-btn[data-v-213b6089]{width:%?690?%;height:%?80?%;line-height:%?80?%;text-align:center;-webkit-border-radius:%?20?%;border-radius:%?20?%;background:-webkit-gradient(linear,right top,left top,from(#ff8e88),to(#fdad28));background:-webkit-linear-gradient(right,#ff8e88,#fdad28);background:linear-gradient(270deg,#ff8e88,#fdad28);border-radius:%?20?%;margin:auto;color:#fff;font-size:%?32?%}.location[data-v-213b6089]{width:%?690?%;height:auto;padding:%?20?% 0;font-size:%?26?%;color:#f44;margin:auto;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end}.location uni-image[data-v-213b6089]{padding-left:%?10?%;width:%?22?%;height:%?22?%}',""]),t.exports=e},d3f1:function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return a}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticStyle:{"padding-bottom":"50rpx"}},[i("v-uni-view",{staticClass:"desc"},[i("v-uni-view",{staticClass:"h1-title"},[t._v("动态信息")]),i("v-uni-textarea",{staticClass:"value",attrs:{placeholder:"请输入动态信息","placeholder-style":"fontsize: 28rpx"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),i("v-uni-view",{staticClass:"line"}),i("v-uni-view",{staticClass:"avatar-info"},[i("v-uni-view",{staticClass:"h1-title"},[t._v("上传图片")]),i("v-uni-view",{staticClass:"up-box"},[i("v-uni-view",{staticClass:"up-load",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upImages.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"iconfont icon-tianjia"})],1),t._l(t.form.photo_show,(function(e,a){return i("v-uni-view",{key:a,staticClass:"up-load",staticStyle:{border:"none"}},[i("v-uni-image",{attrs:{src:e,mode:""}}),i("v-uni-view",{staticClass:"close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteImage(a)}}},[t._v("+")])],1)}))],2)],1),i("v-uni-view",{staticClass:"line"}),i("v-uni-view",{staticClass:"video-box"},[i("v-uni-view",{staticClass:"h1-title"},[t._v("上传视频")]),t.form.video?i("v-uni-view",{staticClass:"video-up-load"},[i("v-uni-video",{staticClass:"video",attrs:{src:t.form.video,controls:!0}}),i("v-uni-view",{staticClass:"close",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.deleteVideo.apply(void 0,arguments)}}},[t._v("+")])],1):i("v-uni-view",{staticClass:"video-up-load",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upLoadVideo.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"iconfont icon-tianjia"})],1)],1),i("v-uni-view",{staticClass:"location",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goLocation.apply(void 0,arguments)}}},[i("v-uni-view",{staticStyle:{color:"#333"}},[t._v(t._s(t.form.address))]),i("v-uni-image",{attrs:{src:t.imgfixUrls+"merchant/where.svg"}}),i("v-uni-view",[t._v("定位")])],1),i("v-uni-view",{staticClass:"footer-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handlesubmitClick.apply(void 0,arguments)}}},[t._v("发布")]),i("PopManager",{attrs:{show:t.isOpenLaction,type:"bottom",overlay:"false",showOverlay:"false"}},[t.latlngs.latitude?i("v-uni-view",{staticClass:"iframe-wid-hgt",style:{height:t.phoneHight,width:t.phoneWidth}},[i("iframe",{attrs:{id:"mapPage",width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?search=1&type=1&key=KIQBZ-6OT3G-AOMQD-IHW6J-PEUDV-VCFAF&referer=myapp&coord="+t.latlngs.latitude+","+t.latlngs.longitude}})]):t._e(),t.latlngs.latitude?t._e():i("v-uni-view",{staticClass:"iframe-wid-hgt",style:{height:t.phoneHight,width:t.phoneWidth}},[i("iframe",{attrs:{id:"mapPage",width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?search=1&type=1&key=KIQBZ-6OT3G-AOMQD-IHW6J-PEUDV-VCFAF&referer=myapp"}})])],1)],1)},n=[]}}]);